/** @class ToolsController */
var ToolsController=function(){function e(e,t,o,n){this.items=[],this.$scope=e,this.$rootScope=t,this.$http=o,this.hasMoved=!1,this.base64=n,this.factor=1.01,this.angle=2,this.isSaving=!1,this.$scope.$=this,this.$scope.items=[],document.getElementById("fileupload").addEventListener("change",this.onFileSelect,!1),msg.on("confirmation-clicked",this.onSaveProjectConfirm,this),msg.on("project-loaded",this.projectLoaded,this),msg.on("update-items",this.updateItems,this),msg.on("update-text-btn-style",this.updateTextBtnStyle,this),msg.on("update-text-btn-weight",this.updateTextBtnWeight,this),msg.on("save-project-popup",this.saveProject,this),keys.bindKey(37,this.moveLeftObject,this),keys.bindKey(38,this.moveUpObject,this),keys.bindKey(39,this.moveRightObject,this),keys.bindKey(40,this.moveDownObject,this),keys.bindKey(27,this.closePopups,this),keys.bindKey(46,this.deleteObj,this),keys.bindKey(107,this.zoomIn,this),keys.bindKey(109,this.zoomOut,this),keys.bindKey(187,this.zoomIn,this),keys.bindKey(189,this.zoomOut,this),keys.bindKey(61,this.zoomIn,this),keys.bindKey(173,this.zoomOut,this),keys.bindKey(107,this.zoomIn,this),keys.bindKey(109,this.zoomOut,this),keys.bindCtrl(103,this.rotateCW,this),keys.bindCtrl(105,this.rotateCCW,this),keys.bindCtrl(38,this.moveObjectUp,this),keys.bindCtrl(40,this.moveObjectDown,this),keys.bindCtrl(46,this.deleteAllObj,this),keys.bindKey(27,this.onEscKeyClick,this),keys.bindKey(112,this.onTutorialClick,this)}return e.prototype.onEscKeyClick=function(){msg.send("on-esc-key-click")},e.prototype.share=function(e){msg.send("share-facebook-twitter",e)},e.prototype.onTutorialClick=function(){open("https://www.onlinelogomaker.com/tutorial","_blank")},e.prototype.removeObject=function(){msg.send("remove-object")},e.prototype.moveLeftObject=function(e){var t=$canvas.getActiveDobj(),o=$cmd.history.length,n=window.event?event:e
void 0!==n&&null!==n&&n.preventDefault(),$(".dropdown").hasClass("open")||Object.keys($canvas.getActiveDobj()).length&&($cmd.run("move",t,-2,0),this.moveStore(o,"left"))},e.prototype.moveUpObject=function(e){var t=$canvas.getActiveDobj(),o=$cmd.history.length,n=window.event?event:e
void 0!==n&&null!==n&&n.preventDefault(),$(".dropdown").hasClass("open")||Object.keys($canvas.getActiveDobj()).length&&($cmd.run("move",t,0,-2),this.moveStore(o,"up"))},e.prototype.moveRightObject=function(e){var t=$canvas.getActiveDobj(),o=$cmd.history.length,n=window.event?event:e
void 0!==n&&null!==n&&n.preventDefault(),$(".dropdown").hasClass("open")||Object.keys($canvas.getActiveDobj()).length&&($cmd.run("move",t,2,0),this.moveStore(o,"right"))},e.prototype.moveDownObject=function(e){var t=$canvas.getActiveDobj(),o=$cmd.history.length,n=window.event?event:e
void 0!==n&&null!==n&&n.preventDefault(),$(".dropdown").hasClass("open")||Object.keys($canvas.getActiveDobj()).length&&($cmd.run("move",t,0,2),this.moveStore(o,"down"))},e.prototype.moveStore=function(e,t){var o=!1
1===e&&1===$cmd.history.length||e>=1&&"move"===$cmd.history[e-1].name&&$cmd.history[e-1].args[0].id===$cmd.history[e].args[0].id&&("right"===t&&0===$cmd.history[e-1].args[2]&&$cmd.history[e-1].args[1]>0&&($cmd.history[e-1].args[1]+=2,o=!0),"left"===t&&0===$cmd.history[e-1].args[2]&&$cmd.history[e-1].args[1]<0&&($cmd.history[e-1].args[1]-=2,o=!0),"up"===t&&0===$cmd.history[e-1].args[1]&&$cmd.history[e-1].args[2]<0&&($cmd.history[e-1].args[2]-=2,o=!0),"down"===t&&0===$cmd.history[e-1].args[1]&&$cmd.history[e-1].args[2]>0&&($cmd.history[e-1].args[2]+=2,o=!0),o===!0&&($cmd.history.splice(e,1),$cmd.index--))},e.prototype.closePopups=function(e){msg.send("close-all-popups")},e.prototype.zoomIn=function(e){var t=$.extend(!0,{},$canvas.getActiveDobj()),o=$canvas.getActiveDobj(),n={x:t.raw.getScaleX(),y:t.raw.getScaleY()},s={x:this.factor*o.raw.getScaleX(),y:this.factor*o.raw.getScaleY()}
this.$cmd.run("scale",o,n,s,o.raw.left,o.raw.top)},e.prototype.zoomOut=function(e){var t=$.extend(!0,{},$canvas.getActiveDobj()),o=$canvas.getActiveDobj(),n={x:t.raw.getScaleX(),y:t.raw.getScaleY()},s={x:1/this.factor*obj.getScaleX(),y:1/this.factor*obj.getScaleY()}
this.$cmd.run("scale",o,n,s,o.raw.left,o.raw.top)},e.prototype.moveObjectUp=function(e){for(var t=0;t<$canvas.children.length;t++)if($canvas.children[t].selected&&t>0){$canvas.children.move(t,t-1),canvas.getActiveObject().moveTo($canvas.getObjZindex($canvas.getActiveObj())+1)
break}},e.prototype.moveObjectDown=function(e){for(var t=0;t<$canvas.children.length;t++)if($canvas.children[t].selected&&t<$canvas.children.length-1){$canvas.children.move(t,t+1),canvas.getActiveObject().moveTo($canvas.getObjZindex($canvas.getActiveObj())-1)
break}},e.prototype.deleteAllObj=function(e){msg.send("remove-objects")},e.prototype.deleteObj=function(e){msg.send("remove-object")},e.prototype.renameObj=function(e){msg.send("open-popup","rename")},e.prototype.addSymobol=function(){msg.send("open-symbols")},e.prototype.addShape=function(){msg.send("open-shapes")},e.prototype.rotateCW=function(){var e=$canvas.getActiveDobj()
$cmd.run("rotate",e,-this.angle)},e.prototype.rotateCCW=function(){var e=$canvas.getActiveDobj()
$cmd.run("rotate",e,this.angle)},e.prototype.duplicateObject=function(){$cmd.run("duplicate")},e.prototype.addText=function(){msg.send("open-popup"),msg.send("open-addtext")},e.prototype.uploadImage=function(){$("#fileupload").click(function(e){}),$("#fileupload").trigger("click")},e.prototype.downloadLogo=function(){msg.send("open-popup","downloadlogo")},e.prototype.new=function(){canvas.getObjects().length&&(msg.send("open-popup"),$("#new-modal").show())},e.prototype.previewProject=function(e){var t=$(".preview"),o=$(e.currentTarget)
return canvas.getObjects().length?"block"==t.css("display")?(t.slideUp(),o.removeClass("input-active"),void(document.getElementById("preview").style.zoom="87%")):(t.slideDown(),o.addClass("input-active"),document.getElementById("preview").style.zoom="87%",void msg.send("preview-project")):(o.removeClass("active"),alert("No objects has been created, please create one first."))},e.prototype.updateTextBtnWeight=function(e){"bold"===e?$("#id-bold-btn").addClass("input-active"):$("#id-bold-btn").removeClass("input-active")},e.prototype.updateTextBtnStyle=function(e){"italic"===e?$("#id-italic-btn").addClass("input-active"):$("#id-italic-btn").removeClass("input-active")},e.prototype.saveProject=function(){msg.send("close-popups")
var e=Tools.getQueryParameters("s")
if($("#register-btn").text(Tools.translateText("register-btn")),$("#login-btn").text(Tools.translateText("login-btn")),$("#register-btn-2").text(Tools.translateText("register-btn")),$("#login-btn-2").text(Tools.translateText("login-btn")),window.logged)msg.send("open-popup"),msg.send("save-project",!0,!1)
else{if(!window.logged)return window.fromDownload=!1,msg.send("open-popup"),void("1"===e||"2"===e||"3"===e||"4"===e?$("#save-modal").show():"5"===e||"6"===e||"7"===e?$("#save-modal-2").show():$("#save-modal-2").show())
window.fromDownload=!1,this.$scope.visible=!1,msg.send("close-popups")}},e.prototype.registerButton=function(){msg.send("close-popups"),msg.send("open-popup"),$("#save-modal").show()},e.prototype.onSaveProjectConfirm=function(e){msg.send("save-project",e)},e.prototype.projectLoaded=function(){this.updateItems(),this.$scope.$apply()},e.prototype.updateItems=function(){this.$scope.items=$canvas.children},e.prototype.onFileSelect=function(e){for(var t,o=1e7,n=e.target.files,s=0;t=n[s];s++)if(t.type.match("image.*"))if(!t.type.size>o)alert("Sorry, no more than 10MBs allowed.")
else{var a=new FileReader
a.onload=function(e){return function(e){msg.send("add-image",e.target.result)}}(t),a.readAsDataURL(t)}else alert("Sorry, only image file type is allowed.")
$("#fileupload").val("")},e}(),DrawingController=function(){function e(e){this.rootScope=this,this.$scope=e,this.$scope.$=this,canvas.isDrawingMode=!1,this.htmlPanel=$(".shape-tools"),msg.on("menu-click",this.onMenuClick,this)}return e.prototype.onMenuClick=function(e){this.isDrawingMode(!0),this.startDrawing(),"draw-shape"!=e&&(this.isDrawingMode(!1),this.stopDrawing())},e.prototype.isDrawingMode=function(e){canvas.isDrawingMode=e},e.prototype.startDrawing=function(){if(fabric.Object.prototype.transparentCorners=!1,this.isDrawingMode(!0),this.htmlPanel.show(),fabric.PatternBrush){var e=new fabric.PatternBrush(canvas)
e.getPatternSrc=function(){var e=fabric.document.createElement("canvas")
e.width=e.height=10
var t=e.getContext("2d")
return t.strokeStyle=this.color,t.lineWidth=5,t.beginPath(),t.moveTo(0,5),t.lineTo(10,5),t.closePath(),t.stroke(),e}}},e.prototype.stopDrawing=function(){this.isDrawingMode(!1),this.htmlPanel.hide()},e}(),SymbolsController=function(){function e(e,n){t=$(".object.add-shape"),o=$(".leftpane .list-group-item.add-symbol"),this.$scope=e,this.$scope.$=this,this.$http=n,this.selectedCategory=0,this.selectedCategoryName="",this.selectedSymbol=0,this.loadedSymbols=!1,this.allSymbols=[],this.allCalls=[],this.currentIndex=0,this.sucessIndex=0,this.search=!1,this.searchSymbols=[],this.categorySymbols=[],this.analyticsDelay=null,this.fullWord="",this.symbolsRootUrl="assets/",this.selectedSymbolUrl="",_this=this,e.$watch("searchBox",function(t,o){if(null===t||void 0===t)e.$.search=!1
else if(""===t)e.$.search=!1,e.$.fillCategories(),e.$.selectedSymbolUrl=e.$.symbolsRootUrl+e.$.categories[e.$.selectedCategory].folder+"/",e.$.selectedCategoryName=e.$.categories[e.$.selectedCategory].name
else if(t.length>=3){var n=[]
_this.sucessIndex=0,_this.currentIndex=0,_this.abortCalls(),ga("send","event","App Click","Symbol Search",t.toString()),e.$.search=!0,e.$.selectedCategoryName="Search"
for(var s=0;s<e.$.allSymbols.length;s++)for(var a=0;a<e.$.allSymbols[s].arr.length;a++)if(null!=e.$.allSymbols[s].arr[a].name.match(t.toString().toLowerCase())){var i={folder:e.$.allSymbols[s].url,content:{name:e.$.allSymbols[s].arr[a].name}}
n.push(i)}else{_.filter(e.$.allSymbols[s].arr[a].synm,function(o){if(null!=o.match(t.toString().toLowerCase())){var i={folder:e.$.allSymbols[s].url,content:{name:e.$.allSymbols[s].arr[a].name}},r=n[n.length-1]
r?r.content.name!=i.content.name&&n.push(i):n.push(i)}})}e.$.searchSymbols=n}}),this.categories=data.categories,msg.on("on-esc-key-click",this.close,this),msg.on("open-symbols",this.open,this),msg.on("load-symbols",this.load,this),this.htmlString=svgImg.stringToHtml()
var s=Tools.getQueryParameters("search")
"1"===s?$("#searchBox").show():$("#searchBox").hide(),$(document).mouseup(function(e){o.is(e.target)||t.show(),t.is(e.target)||0!==t.has(e.target).length||o.is(e.target)||$("#olm-search").is(":focus")||(this.search=!1,$("#olm-search").val(""),t.hide())})}var t,o
return e.prototype.load=function(){var e=this
if(!e.loadedSymbols)return new Promise(function(t,o){var n=Tools.QueryString()
n.lang||(n.lang="en"),e.$http.get("assets/symbols/"+n.lang+"/list_small.json?v="+Math.floor(Date.now()/1e3)).then(function(o){o.data.sort(function(e,t){return e.name>t.name?1:t.name>e.name?-1:0}),e.$scope.$.categories=o.data
for(var n=0;n<o.data.length;n++){var s={}
s.url=e.symbolsRootUrl+o.data[n].folder+"/",s.category=o.data[n].name,s.arr=[],e.allSymbols.url=e.symbolsRootUrl+o.data[n].folder+"/"
for(var a=0;a<o.data[n].content.length;a++)s.arr.push(o.data[n].content[a])
e.allSymbols.push(s)}e.selectedSymbolUrl=e.symbolsRootUrl+o.data[e.selectedCategory].folder+"/",e.selectedCategoryName=o.data[e.selectedCategory].name,e.selectedCategory=0,e.fillCategories(),e.loadedSymbols=!0,t(e.loadedSymbols)})})},e.prototype.fillCategories=function(){this.categorySymbols=[]
for(var e=0;e<this.categories[this.selectedCategory].content.length;e++){var t={},o=!0
t.folder=this.symbolsRootUrl+this.categories[this.selectedCategory].folder+"/",t.content=this.categories[this.selectedCategory].content[e]
for(var n=0;n<this.categorySymbols.length;n++)t.content.name==this.categorySymbols[n].content.name&&(o=!1)
o&&this.categorySymbols.push(t)}},e.prototype.getSymbolData=function(){var e=this,t=e.currentIndex
if(!(t>=this.getSelectedCategorySymbols().length))if(this.search){var o=this.searchSymbols[t].folder+this.searchSymbols[t].content.name
e.currentIndex++,$.ajax({url:o,type:"GET",beforeSend:function(t,o){e.allCalls.push(t)},success:function(t){if(null!=t){var n=(new XMLSerializer).serializeToString(t),s=encodeURIComponent(n),a="data:image/svg+xml;charset=utf8,"+s
$("#currimg"+e.sucessIndex.toString()).attr("src",a),$("#currimg"+e.sucessIndex.toString()).attr("meta",o),e.sucessIndex++}},error:function(e,t){}})}else{var o=this.selectedSymbolUrl+this.getSelectedCategorySymbols()[t].content.name
e.currentIndex++,$.ajax({url:o,type:"GET",beforeSend:function(t,o){e.allCalls.push(t)},success:function(t){if(null!=t){var n=(new XMLSerializer).serializeToString(t),s=encodeURIComponent(n),a="data:image/svg+xml;charset=utf8,"+s
$("#currimg"+e.sucessIndex.toString()).attr("src",a),$("#currimg"+e.sucessIndex.toString()).attr("meta",o),e.sucessIndex++}},error:function(e,t){}})}},e.prototype.abortCalls=function(){$.each(_this.allCalls,function(e,t){t.abort()})},e.prototype.onEscKeyClick=function(){this.search=!1,$("#olm-search").val(""),this.close()},e.prototype.open=function(){_this=this,this.loadedSymbols?t.show():(glassLoader.start(),this.load().then(function(){t.show(),glassLoader.stop()}))},e.prototype.close=function(){this.search=!1,this.abortCalls(),$("#olm-search").val(""),t.hide()},e.prototype.getCategoryStyle=function(e){return e==this.selectedCategory?"category-item-selected":""},e.prototype.getSymbolStyle=function(e){return e==this.selectedSymbol?"symbol-item-selected":""},e.prototype.getSelectedCategorySymbols=function(){return this.search?this.searchSymbols:void 0!=this.categories[this.selectedCategory]?this.categorySymbols:null},e.prototype.onCategoryClick=function(e,t){this.selectedCategory=e,this.selectedSymbol=0,this.abortCalls(),this.selectedSymbolUrl="",this.currentIndex=0,this.sucessIndex=0,this.selectedSymbolUrl=this.symbolsRootUrl+this.categories[this.selectedCategory].folder+"/",this.selectedCategoryName=this.categories[this.selectedCategory].name,this.categories[this.selectedCategory].cssClass="",this.categories[this.selectedCategory].cssClass="category-item-selected",this.search=!1,this.fillCategories(),$("#categories-scroll").animate({scrollTop:0},"fast"),$("#olm-search").val("")},e.prototype.onSymbolClick=function(e,t){if($(".selected").removeClass("selected"),t.currentTarget.children.length>0)for(var o in t.currentTarget.children)t.currentTarget.children[o].className+=" selected"
this.selectedSymbol=e
var n=this.selectedSymbolUrl+this.getSelectedCategorySymbols()[this.selectedSymbol].content.name
ga("send","event","App Click","Symbol Select",n.toString())
var s={resp:!1}
msg.send("is-active-guided-tour",s),s.resp?(msg.send("add-symbol-guided-tour",this.selectedSymbolUrl+this.getSelectedCategorySymbols()[this.selectedSymbol]),msg.send("close-popups")):this.onOkClick(),this.close()},e.prototype.onCancelClick=function(){msg.send("close-popups")},e.prototype.onOkClick=function(){var e=$("#currimg"+this.selectedSymbol).attr("meta")
this.abortCalls(),msg.send("add-symbol",e),msg.send("close-popups")},e}(),PopupsController=function(){function e(e){this.$scope=e,msg.on("close-popups",this.close,this),msg.on("open-popups",this.open,this),msg.on("open-addtext",this.open,this),msg.on("open-invalid-user-pass",this.open,this),msg.on("open-popup",this.openPopup,this)}return e.prototype.open=function(){this.$scope.visible=!0},e.prototype.openPopup=function(e){this.$scope.visible=!0,msg.send("open-"+e)},e.prototype.close=function(){this.$scope.visible=!1},e}(),CanvasController=function(){function CanvasController(e,t,o){var n=this
this.isBGcolor=!0,this.touched=!1,this.PROJECT_PREFIX="project_",this.projectName=null,this.projectDate=new Date,this.$scope=e,this.$cmd=t,this.$compile=o,this.didFirstMove=null,this.moveTracker=[],this.rotateTracker=[],this.typingTracker=[],this.afterTyping=null,this.afterMove,this.afterRotate,this.oldColor="fff",this.newColor="fff",e.$=this,CanvasController.instance=this,canvas=this.canvas=new fabric.Canvas("canvas",{selection:!1}),$canvas=new CanvasService(canvas),canvas.setWidth(window.innerWidth),canvas.setHeight(window.innerHeight),canvas.selection=!0,document.getElementById("grid").backgroundColor="#fff",canvas.forEachObject(function(e){var t=document.getElementById("grid").backgroundColor
e.borderColor=invertColor(t),e.cornerColor=invertColor(t)}),$("#colorpicker-holder-bg").ColorPicker({flat:!0,onSubmit:function(e,t,o,s){n.oldColor=n.newColor,n.newColor=t,n.backgroundColor(t),$(".colorpicker_undo")[2].style.display="block"},onChange:function(e,t,o,s){n.backgroundColor(t)},onShow:function(){$("#colorpicker-holder-bg").ColorPickerSetColor("#ffffff")},onBeforeShow:function(){$("#colorpicker-holder-bg").ColorPickerSetColor("#ffffff")}}),$("#colorpicker-holder-bg").hide(),$(".text-picker").keyup(function(){$(this).val("")}),$("#color-box").click(function(e){$("#mlSelectedColorText").off(),$("#mlColors").off(),$(".colorpicker")[2].style.left=e.clientX.toString()+"px",$(".colorpicker")[2].style.top=e.clientY.toString()+"px",$(".colorpicker_undo")[2].style.display="none",n.oldColor=document.getElementById("grid").backgroundColor.substring(1),n.newColor=document.getElementById("grid").backgroundColor.substring(1),$("#colorpicker-holder-bg").ColorPickerSetColor(document.getElementById("grid").backgroundColor.substring(1)),$("#colorpicker-holder-bg").show(),$("#mlSelectedColorText").keyup(function(){n.onColorChange(this.value)}),$("#mlColors").mouseleave(function(){var e=$canvas.getActiveDobj(),t=$canvas.getOriginColorByObj(e.raw,e.id)
Object.keys(t).length&&n.onColorChange(rgb2hex(t.fill))})}),canvas.on("text:changed",this.onTextChanged),canvas.on("mouse:up",this.removeOpacityAll),canvas.on("object:moving",this.onObjectMove),canvas.on("object:modified",this.onObjectModified),canvas.on("object:rotating",this.onObjectRotate),canvas.on("object:selected",this.onObjectSelect),canvas.on("selection:cleared",this.onObjectSelectCleared),canvas.on("selection:created",this.onObjectSelectCreated),msg.on("share-facebook-twitter",this.shareFT,this),msg.on("object-modified",this.onObjectModified),msg.on("remove-opacity-all",this.removeOpacityAll),msg.on("deselect-all",this.deselectAll),msg.on("scale-obj",this.scaleObj),msg.on("move",this.move,this),msg.on("add-symbol",this.addSymbol,this),msg.on("add-image",this.addImage,this),msg.on("add-text",this.addText,this),msg.on("text-font",this.textFont,this),msg.on("remove-object",this.removeObject,this),msg.on("remove-objects",this.removeObjects,this),msg.on("draw-action-buttons",this.darwActionButtons,this),msg.on("clear-action-buttons",this.clearActionButtons,this),msg.on("on-grid-click",this.onGridClick,this),msg.on("set-background-color",this.setBackgroundColor,this),msg.on("download-canvas",this.downloadCanvas,this),msg.on("prepare-canvas-size",this.prepareCanvasSize,this),msg.on("save-project",this.saveProject,this),msg.on("reset-project-name",this.resetProjectName,this),msg.on("touchedCanvas",this.touchedCanvas,this),msg.on("preview-project",this.previewProject,this),msg.on("update-undo-redo-state",this.updateUndoRedoState,this),msg.on("clear-history",this.clearHistory,this),msg.on("submit-undo",this.bgcolorUndo,this),t.map("background-color",this.onColorSelect,this,4),t.map("add-symbol",this.addSymbol),t.map("duplicate",this.duplicate,this,3),t.map("move",this.move,this,1),t.map("moved",this.moved,this,0),t.map("rotate",this.rotate,this,1),t.map("scale",this.scale,this,0),t.map("text-color",this.textColor,this,0),t.map("text-changed",this.textChanged,this,0),t.map("text-text-decoration",this.textDecoration,this,4),t.map("text-text-stroke",this.textStroke,this,4),t.map("text-text-align",this.textAlign,this,4),t.map("text-font-text-line-height",this.textLineHeight,this,4),t.map("text-background-color",this.textBackgroundColor,this,4),t.map("text-font",this.textFont,this,4),t.map("text-font-style",this.textFontStyle,this,4),t.map("text-font-weight",this.textFontWeight,this,4),e.undoActive=!1,e.redoActive=!1,keys.bindCtrl(90,this.onUndoClick,this),keys.bindCtrl(89,this.onRedoClick,this)}return CanvasController.prototype.updateUndoRedoState=function(e,t){var o=this
this.$scope.undoActive=e,this.$scope.redoActive=t,setTimeout(function(){o.$scope.$apply()},50),this.clearActionButtons(),canvas.renderAll()},CanvasController.prototype.bgcolorUndo=function(e){var t=this
t.newColor=t.oldColor,t.backgroundColor(t.newColor),$(".colorpicker_undo")[2].style.display="none",$("#colorpicker-holder-bg").ColorPickerSetColor(t.newColor)},CanvasController.prototype.shareFT=function(e){function t(){var e,t=500,o=300,n=$(window).height()/2-o/2,s=$(window).width()/2-t/2
e="width="+t+",height="+o+",top="+n+",left="+s,window.open("https://twitter.com/intent/tweet?text=Online%20Logo%20Maker%20-%20Create%20Your%20Logo&url="+v+"&via=logogenerator","_blank",e,!1)}function o(e){FB.ui({method:"share",name:"Facebook Dialogs",href:"https://onlinelogomaker.com/",link:"https://developers.facebook.com/docs/dialogs/",picture:e,caption:"ONLINE LOGO MAKER",description:"Image created by Online Logo Maker"},function(e){})}function n(e){$.ajax({method:"POST",url:"http://advanced1879.inmotionhosting.com:3000/",data:JSON.stringify({img:e,type:"save"}),async:!1}).done(function(e){m=e.img,v=e.page}).fail(function(){console.log("Image wasn't saved")})}glassLoader.start()
var s=450,a=250,i=0,r=0,l=canvas.width,c=canvas.height,d=0,p=0,h=0
$canvas.selectAll(),i=$canvas.getActiveGroup().width,r=$canvas.getActiveGroup().height,p=$canvas.getActiveGroup().top,h=$canvas.getActiveGroup().left,s-=30,a-=30,d=s/i<a/r?s/i:a/r,s+=30,a+=30,canvas.setWidth(s),canvas.setHeight(a),$canvas.getActiveGroup().set({scaleX:d,scaleY:d,left:canvas.width/2,top:canvas.height/2,originX:"center",originY:"center"})
var g=document.getElementById("grid")
canvas.backgroundColor=g.backgroundColor,canvas.deactivateAllWithDispatch().renderAll()
var u=canvas.toDataURL("png")
u=u.replace("data:image/png;base64,","")
var m,v
switch(n(u),$canvas.selectAll(),canvas.setWidth(l),canvas.setHeight(c),d=1/d,$canvas.getActiveGroup().set({scaleX:d,scaleY:d,left:h,top:p,originX:0,originY:0}),canvas.deactivateAllWithDispatch().renderAll(),e){case 1:o(m)
break
case 2:t()}canvas.backgroundColor="",glassLoader.stop()},CanvasController.prototype.clearHistory=function(){this.$scope.undoActive=!1,this.$scope.redoActive=!1},CanvasController.prototype.duplicate=function(){var e=$.extend(!0,{},$canvas.getActiveDobj()),t=$.extend(!0,{},e.raw),o=e.type,n=t,s=35,a=15,i=!0
switch(t.type){case"i-text":case"text":n=t.clone(),i=!0
break
case"group":case"path-group":o=DOType.SYMBOL
for(var r=0;r<n.paths.length;r++)n.paths[r]=$.extend(!0,{},n.paths[r])
break
default:n=fabric.util.object.clone(t),i=!1}$cmd.run("add",$canvas.create(o,n,i,$canvas.getActiveDobj().shadow),i,s,a),$canvas.getLastObj().top+$canvas.getLastObj().height+80>canvas.height&&($canvas.getLastObj().top=50,$canvas.getLastObj().setCoords(),canvas.renderAll()),$cmd.history[$cmd.history.length-1].args[2]=0,$cmd.history[$cmd.history.length-1].args[3]=0},CanvasController.prototype.rotate=function(e,t){e.raw.rotate(e.raw.getAngle()+t),canvas.renderAll()},CanvasController.prototype.move=function(e,t,o){msg.send("object-modified",e),e.raw.setLeft(e.raw.left+t),e.raw.setTop(e.raw.top+o),e.raw.setCoords(),canvas.renderAll()},CanvasController.prototype.moved=function(e,t,o){var n=CanvasController.instance
e.raw.set({left:o.left,top:o.top}).setCoords(),n.darwActionButtons(e.raw),canvas.renderAll()},CanvasController.prototype.scale=function(e,t,o,n,s){e.raw?e.raw.set({scaleX:o.x,scaleY:o.y,top:o.t,left:o.l}):e.set({scaleX:o.x,scaleY:o.y,top:o.t,left:o.l}),msg.send("update-scale"),canvas.renderAll()},CanvasController.prototype.scaleObj=function(e,t,o){e.set({scaleX:t,scaleY:o,originX:"center",originY:"center"}),msg.send("update-scale-obj")},CanvasController.prototype.textChanged=function(e,t,o){e.raw.setText(o),canvas.renderAll()},CanvasController.prototype.textColor=function(e,t,o){var n=CanvasController.instance
o.indexOf("#")==-1&&(o="#"+o),$canvas.setFillColor(e.raw,e.id,o),e.raw.fill=o,n.darwActionButtons(e.raw)},CanvasController.prototype.textFont=function(e,t){this.selected.fontFamily=t,canvas.renderAll(),msg.send("update-text-font")},CanvasController.prototype.textFontStyle=function(e,t){this.selected.fontStyle=t,msg.send("update-text-btn-style",t),canvas.renderAll()},CanvasController.prototype.textFontWeight=function(e,t){this.selected.fontWeight=t,msg.send("update-text-btn-weight",t),canvas.renderAll()},CanvasController.prototype.textDecoration=function(e,t){this.selected.textDecoration=t,canvas.renderAll()},CanvasController.prototype.textStroke=function(e,t){this.selected.stroke=t,canvas.renderAll()},CanvasController.prototype.textAlign=function(e,t){this.selected.textAlign=t,canvas.renderAll()},CanvasController.prototype.textLineHeight=function(e,t){this.selected.lineHeight=t,canvas.renderAll()},CanvasController.prototype.textBackgroundColor=function(e,t){this.selected.textBackgroundColor=t,canvas.renderAll()},CanvasController.prototype.addSymbol=function(e,t,o){var n=this
fabric.loadSVGFromURL(e,function(e,s){e.options=s
var a=fabric.util.groupSVGElements(e,s)
if(window.defaultproject&&!n.touched){var i={x:$canvas.children[0].raw.left,y:$canvas.children[1].raw.top}
$cmd.run("remove",$canvas.children[0]),$cmd.run("add",$canvas.create(DOType.SYMBOL,a),!1,i.x,i.y),$canvas.children[0].raw.scaleX=2.5*$canvas.children[0].raw.scaleX,$canvas.children[0].raw.scaleY=2.5*$canvas.children[0].raw.scaleY,$canvas.children[0].raw.top=$canvas.children[1].raw.top-$canvas.children[0].raw.height*$canvas.children[0].raw.scaleY,$canvas.children[0].raw.left=$canvas.children[1].raw.left+$canvas.children[1].raw.width*$canvas.children[1].raw.scaleX/2-$canvas.children[0].raw.width*($canvas.children[0].raw.scaleX/2),$canvas.children[0].raw.setCoords(),n.touched=!0}else $cmd.run("add",$canvas.create(DOType.SYMBOL,a),!1,t,o),n.touched=!0
canvas.renderAll(),canvas.getObjects().length>1&&($(".object-option").show(),$(".title").show(),$(".object-option .text-container").hide(),$("#id-zindex-buttonbar").show())}),msg.send("update-items"),canvas.renderAll()},CanvasController.prototype.addImage=function(e){var t=this
fabric.Image.fromURL(e,function(e){var o=window.innerWidth/2-e.width/2,n=window.innerHeight/2-e.height/2
$cmd.run("add",$canvas.create(DOType.IMAGE,e),!1,o,n),t.touched=!0,canvas.getObjects().length>1&&($(".object-option").show(),$(".title").show(),$(".object-option .text-container").hide(),$("#id-zindex-buttonbar").show())}),msg.send("update-items"),canvas.renderAll()},CanvasController.prototype.addText=function(e,t,o){var n=0,s=0
if($canvas.children.length>0){var a=$canvas.children[0].raw
n=15,s=30,n+=a.left,s+=a.top}var i=new fabric.IText(e,{left:n,top:s,padding:0,fontFamily:"Adamcg-Pro"})
$cmd.run("add",$canvas.create(DOType.ITEXT,i),!1,t,o),this.touched=!0,$canvas.children.length>0&&$canvas.getLastObj().top+$canvas.getLastObj().height+80>canvas.height&&($canvas.getLastObj().top=50,$canvas.getLastObj().setCoords(),canvas.renderAll()),msg.send("update-items")},CanvasController.prototype.addListeners=function(e){e.on("selected",this.onObjectMove),e.on("moving",this.onObjectMove)},CanvasController.prototype.onObjectSelect=function(e){var t=CanvasController.instance,o=$canvas.getActiveDobj()
CanvasController.instance.selected=e.target,void 0!==o&&null!==o&&void 0!==e.e&&null!==e.e&&Object.keys(o).length&&(t.moveTracker.push({dobj:o,top:o.raw.top,left:o.raw.left}),null!==o.raw.text&&void 0!==o.raw.text&&t.typingTracker.push(o.raw.text),t.rotateTracker.push({angle:$canvas.getActiveDobj().raw.angle}),canvas.object=e.target,t.darwActionButtons(e.target))},CanvasController.prototype.onObjectSelectCreated=function(e){this.onObjectSelect(e)},CanvasController.prototype.onObjectSelectCleared=function(e){var t=CanvasController.instance
t.removeActionButtons(),msg.send("deselect-all")},CanvasController.prototype.onTextChanged=function(e){var t=CanvasController.instance,o=$canvas.getActiveDobj(),n=o.raw.text
0!==t.typingTracker.length&&(clearTimeout(this.afterTyping),delete this.afterTyping,this.afterTyping=setTimeout(function(){t.typingTracker.push(o.raw.text)
var e=t.typingTracker.length
$cmd.store("text-changed",o,t.typingTracker[e-2],n)},200))},CanvasController.prototype.onKeyboardPressed=function(e){},CanvasController.prototype.onObjectMove=function(e){if(null!==canvas.getActiveObject()&&void 0!==canvas.getActiveObject()){msg.send("transformed",e)
var t=CanvasController.instance,o=$.extend(!0,{},$canvas.getActiveDobj()),n={},s={}
t.moveTracker.push({dobj:o,top:o.raw.top,left:o.raw.left}),clearTimeout(this.afterMove),delete this.afterMove,this.afterMove=setTimeout(function(){var e=$canvas.getActiveDobj()
n={top:t.moveTracker[0].top,left:t.moveTracker[0].left},s={top:e.raw.top,left:e.raw.left},$cmd.run("moved",e,n,s),t.moveTracker=[]},100),t.removeActionButtons()}},CanvasController.prototype.onObjectModified=function(e){var t=CanvasController.instance
e=e.target?e.target:e.raw,t.darwActionButtons(e)},CanvasController.prototype.onObjectRotate=function(e){var t=CanvasController.instance,o=$.extend(!0,{},$canvas.getActiveDobj())
t.rotateTracker.push({angle:o.raw.angle}),clearTimeout(this.afterRotate),delete this.afterRotate,this.afterRotate=setTimeout(function(){var e=$canvas.getActiveDobj(),o=e.raw.angle-t.rotateTracker[0].angle
$cmd.store("rotate",e,o),t.rotateTracker=[]},100)},CanvasController.prototype.onRedoClick=function(){this.$cmd.redo()},CanvasController.prototype.onUndoClick=function(){this.$cmd.undo()},CanvasController.prototype.backgroundColor=function(e){$oCanvasColor.previous=$oCanvasColor.current,$oCanvasColor.current=e,$cmd.run("background-color",$oCanvasColor.previous,e)},CanvasController.prototype.onColorSelect=function(e,t){var o="#"+t
document.getElementById("grid")
$(".background-picker div").css("background-color",o),this.setBackgroundColor(e,o)},CanvasController.prototype.onColorChange=function(e,t){var o="#"+t
$(".background-picker div").css("background-color",o),this.setBackgroundColor(e,o)},CanvasController.prototype.setBackgroundColor=function(e,t){var o=document.getElementById("grid")
o.backgroundColor=t,ctx=o.getContext("2d"),ctx.fillStyle=t,ctx.fillRect(0,0,canvas.width,canvas.height),this.onGridClick(!1),canvas.forEachObject(function(e){e.borderColor=invertColor(t),e.cornerColor=invertColor(t)})},CanvasController.prototype.onGridClick=function(enabled,disable){var toggle=document.getElementById("gridToggle"),text="GRID",gridColor="#3D3D3D",canvasColor=document.getElementById("grid").backgroundColor
toggle.className="grid btn btn-default gridOnOff",enabled=eval(enabled),enabled&&(toggle.value=!eval(toggle.value)),disable&&(toggle.value=!1),eval(toggle.value)?(toggle.className+=" active",gridColor=invertColor(canvasColor)):gridColor=canvasColor?canvasColor:"#fff",this.toggleGrid(gridColor)},CanvasController.prototype.toggleGrid=function(e){gridCanvas=document.getElementById("grid_1"),context=gridCanvas.getContext("2d")
var t=gridCanvas.width=window.innerWidth,o=gridCanvas.height=window.innerHeight
if(x=0,y=0,w=t,h=o,this.minorDotSize=1.5,context.beginPath(),context.rect(x,y,w,h),context.clip(),minorRes=20,context.strokeStyle=e,context.fillStyle=e,minorRes){context.beginPath()
for(var n=x;n<=x+w;n+=minorRes)for(var s=y;s<=y+h;s+=minorRes)context.rect(n-.2*this.minorDotSize,s-.2*this.minorDotSize,this.minorDotSize,this.minorDotSize)
context.fill()}},CanvasController.prototype.clearActionButtons=function(){$(".actionButtons").remove()},CanvasController.prototype.darwActionButtons=function(e){var t=CanvasController.instance
_
var o=$(".actionButtons")
if(null!==canvas.getActiveObject()&&void 0!==canvas.getActiveObject()){this.clearActionButtons()
var n,s,a,i,r,l,c,d,p,h,g,u,m,v,f,w,b=40,y=-40
setTimeout(function(){o.remove(),t.clearActionButtons(),n=e.width/2,s=e.height/2,a=e.scaleX,i=e.scaleY,void 0!==e.oCoords&&null!==e.oCoords?(r=e.oCoords.tr.x,l=e.oCoords.tr.y,c=e.oCoords.bl.x,d=e.oCoords.bl.y,p=c+r,h=d+l):(p=e.left,h=e.top),midX=(e.oCoords.br.x+e.oCoords.tl.x)/2,midY=(e.oCoords.mr.y+e.oCoords.ml.y)/2,n*=a,g=midX+e.getBoundingRect().width/2,u=midY,g+=b,m=u+y,f=u,w=u-y,v=u-2*y
var C,x,k,S,j
x='<button onclick="$cmd.run(\'duplicate\');" class="btn btn-default actionButtons dupBtn"title="Duplicate" style="position:absolute;top:'+m+"px;left:"+g+'px; z-index: 3;" title="Duplicate object">'+Tools.translateText("duplicate-text")+"</button>",k='<button onclick="$cmd.run(\'remove\', $canvas.getActiveDobj());" class="btn btn-default actionButtons delBtn"title="Delete" style="position:absolute;top:'+v+"px;left:"+g+'px; z-index: 3;" title="Remove object">'+Tools.translateText("delete-text")+"</button>",S='<button onclick="msg.send (\'object-bringforward\');" id="bring-forward-btn" class="btn btn-default actionButtons bringforwardBtn"title="Delete" style="position:absolute;top:'+f+"px;left:"+g+'px; z-index: 3;" title="Remove object">'+Tools.translateText("id-bringforward-btn")+"</button>",j='<button onclick="msg.send (\'object-sendbackwards\');" id="send-backwards-btn" class="btn btn-default actionButtons sendbackwardsBtn"title="Delete" style="position:absolute;top:'+w+"px;left:"+g+'px; z-index: 3;" title="Remove object">'+Tools.translateText("id-sendbackwards-btn")+"</button>",C=x+S+j+k,$(".canvas").append(t.$compile(C)(t.$scope))
var T=canvas.getActiveObject(),O=canvas.getObjects().indexOf(T),A=0===O,D=O==canvas.getObjects().length-1
$("#bring-forward-btn").prop("disabled",D),$("#send-backwards-btn").prop("disabled",A)},150)}},CanvasController.prototype.removeActionButtons=function(){$(".actionButtons").remove()},CanvasController.prototype.setZoom=function(e){var t=canvas.getObjects()
for(var o in t){var n=t[o].scaleX,s=t[o].scaleY,a=t[o].left,i=t[o].top,r=n*e,l=s*e,c=a*e,d=i*e
t[o].scaleX=r,t[o].scaleY=l,t[o].left=c,t[o].top=d,canvas.renderAll(),t[o].setCoords()}canvas.renderAll()},CanvasController.prototype.removeObject=function(){$canvas.children.forEach(function(e){e.selected&&$cmd.run("remove",e)}),this.touched=!0,canvas.renderAll()},CanvasController.prototype.removeObjects=function(){$cmd.run("remove-all"),canvas.renderAll()},CanvasController.prototype.removeOpacityAll=function(){$canvas.children.forEach(function(e){e.type==DOType.SYMBOL&&e.raw.getObjects().forEach(function(e){e.hasOwnProperty("invisible")?e.invisible||e.setOpacity(1):e.setOpacity(1)})}),canvas.renderAll()},CanvasController.prototype.deselectAll=function(e){$canvas.children.forEach(function(e){e.type==DOType.SYMBOL&&e.raw.getObjects().forEach(function(e){e.hasOwnProperty("invisible")&&(e.invisible?e.setOpacity(0):e.setOpacity(1))}),e.selected=!1})},CanvasController.prototype.getProportionalCanvas=function(e,t,o,n){var s=this,a=document.createElement("canvas").getContext("2d"),i=document.createElement("canvas"),r=i.getContext("2d"),l=0,c=0
window.cancelRequestAnimFrame(window.renderAnimationFrame),n&&(l=o),o&&(c=n)
var d=document.getElementById("grid"),p=d.backgroundColor
return p&&(d.backgroundColor="",i.backgroundColor=""),t&&!p&&(p="#fff"),this.removeOpacityAll(),canvas.deactivateAllWithDispatch().renderAll(),new Promise(function(e,o){setTimeout(function(){var o=s.getRectBounds(),n=o.bottom-o.top,i=o.right-o.left,d=canvas.getContext()
t&&(d.globalCompositeOperation="destination-over",d.fillStyle=p,d.fillRect(0,0,canvas.width,canvas.height)),p&&s.setBackgroundColor(p,p),trimmed=d.getImageData(o.left,o.top,i,n),a.canvas.width=i,a.canvas.height=n,a.putImageData(trimmed,0,0)
var h=i+l,g=n+c
r.canvas.width=h,r.canvas.height=g,t&&(r.globalCompositeOperation="destination-over",r.fillStyle=p,r.fillRect(0,0,canvas.width,canvas.height)),r.putImageData(a.getImageData(0,0,i,n),l/2,c/2),window.copy2ctx=r,d.globalCompositeOperation="source-over",canvas.renderAll(),e(1)},10)})},CanvasController.prototype.downloadCanvas=function(e,t,o,n,s,a,i,r,l,c){var d=this
l===!1&&(t=this.isBGcolor),msg.send("download-in-progress"),this.getProportionalCanvas(e,t,o,n,s,a,i,r).then(function(){function e(){var e=Base64Binary.decode(m,null),n={name:h,imgRaw:e,width:s,height:a,areacolor:t,ext:".png"}
if(window.downloadFiles.unshift(n),l&&(t||500==s)){var i=Base64Binary.decode(u,null),r={name:h,imgRaw:i,width:s,height:a,areacolor:!0,ext:".jpg"}
window.downloadFiles.unshift(r)}if(c){var p=""
g.file(h+".png",e,{base64:!0})
for(var v=0;v<window.downloadFiles.length;v++)p="",window.downloadFiles[v].areacolor||(p="-transparent"),g.file(h+"-"+window.downloadFiles[v].width+p+window.downloadFiles[v].ext,window.downloadFiles[v].imgRaw,{base64:!0})
var f={},w=new fabric.Canvas("clonee"),b=JSON.stringify(canvas)
w.loadFromJSON(b,function(){for(var e,t,n=["arial"],s=w.getObjects("i-text"),a=w.getObjects("text"),i=window.location.href.match(/^[^\#\?]+/)[0]+"assets/fonts/",r="",c=w.getObjects(),p=Number.MAX_VALUE,u=Number.MAX_VALUE,m=0,v=0,b=0;b<c.length;b++)c[b].top<p&&(p=c[b].top),c[b].left<u&&(u=c[b].left)
p-=10,u-=10
for(var b=0;b<c.length;b++)c[b].top=c[b].top-p,c[b].left=c[b].left-u,e=c[b].left+c[b].width*c[b].scaleX,t=c[b].top+c[b].height*c[b].scaleY,e>m&&(m=e),t>v&&(v=t)
for(w.width=m+=10,w.height=v+=10,f=w.toSVG(),r+="Logo designed using Online Logo Maker\r\nhttps://onlinelogomaker.com\r\n\r\nFonts used in this project:\r\n\r\n",b=0;b<s.length;b++){n.push(s[b].fontFamily),f=f.replace(s[b].fontFamily,"'"+Tools.mapOlmFont(s[b].fontFamily)+"'")
Tools.mapOlmFont(s[b].fontFamily)
r+=i+s[b].fontFamily+".ttf\r\n"}for(b=0;b<a.length;b++){n.push(a[b].fontFamily),f=f.replace(a[b].fontFamily,"'"+Tools.mapOlmFont(a[b].fontFamily)+"'")
Tools.mapOlmFont(a[b].fontFamily)
r+=i+a[b].fontFamily+".ttf\r\n"}var y=Base64Binary.encode(f)
if(l){var C
$.ajax({type:"POST",url:"server/php/GetNewFormat.php",data:{image:y},async:!1}).done(function(e){C=e.image})
var x=Base64Binary.decode(C,null)
g.file(h+".eps",x)}r+="\r\n\r\nInstructions to install fonts on windows: \r\n 1- Find and Download your fonts from the links above \r\n 2- Double click the .ttf file \r\n 3- Click on the install button and allow it to install",g.file("Readme.txt",r),g.file(h+".svg",f),g.generateAsync({type:"blob"}).then(function(e){}),document.cookie="projectName="+d.projectDate.getTime()+"; path=/; domain=.onlinelogomaker.com";(function(){var e={fileName:h,png:o}
window.logged&&parseInt(window.user.premium_status)?g.generateAsync({type:"base64"}).then(function(t){e.zip=t,d.sendPostData(e)}):d.sendPostData(e)})()})}msg.send("download-complete"),ga("send","event","IfPreviewGenerated","Yes",{nonInteraction:1})}var o,n=window.copy2ctx,i=n.canvas,r=document.createElement("canvas")
r.height=i.height,r.width=i.width
var p=r.getContext("2d")
p.drawImage(i,0,0)
var h=Tools.generateOlmFileName(),g=new JSZip,o=r.toDataURL("png")
o=o.replace("data:image/png;base64,","")
var u=o,m=o
if(l){var v=document.getElementById("grid").backgroundColor
v||(v="#FFF"),$.ajax({type:"POST",url:"server/php/GetResolution.php",data:{image:o,bgColor:v},async:!1}).done(function(t){m=t.imagepng,u=t.imagejpg,e()})}else e()}).catch(function(e){console.log("Handle rejected promise ("+e+") here."),glassLoader.stop(),ga("send","event","IfPreviewGenerated","No",{nonInteraction:1}),alert("Sorry, something went wrong, please try again later or contact support.")})},CanvasController.prototype.sendPostData=function(e){$.ajax({type:"POST",url:"https://www.onlinelogomaker.com/applet_scripts/downloadlogo.php",data:e,success:function(e){var t=document.getElementById("dlink")
t.href=e,t.innerHTML=Tools.translateText("download-logo-text"),t=document.getElementById("downloadImg")
var o=t.parentNode,n=document.createElement("a")
n.href=e,n.id="wrapperImg",n.target="_blank",n.className="child",o.replaceChild(n,t),n.appendChild(t),t.src="img/cloud.png",msg.send("save-project",!0,!0),msg.send("zip-complete"),ga("send","event","IfPreviewReceived","Yes",{nonInteraction:1})}}).fail(function(){ga("send","event","IfPreviewReceived","No",{nonInteraction:1})})},CanvasController.prototype.prepareCanvasSize=function(e){var t=void 0,o=!1,n=0,s=0
this.getProportionalCanvas(t,o,n,s).then(function(){msg.send(e)})},CanvasController.prototype.previewProject=function(e){var t,o,n=void 0,s=!1,a=0,i=0,r=document.getElementsByClassName("object-preview")[0].childNodes
this.getProportionalCanvas(n,s,a,i).then(function(){t=window.copy2ctx,o=t.canvas.toDataURL()
for(var e in r)if(void 0!=r[e].childNodes&&r[e].childNodes.length)for(var n in r[e].childNodes)void 0!=r[e].childNodes[1]&&(r[e].childNodes[1].src=o)
canvas.renderAll()}).catch(function(e){console.log("Handle rejected promise ("+e+") here.")})},CanvasController.prototype.saveProject=function(e,t){var o=this
if(e&&window.logged){var n=this.projectDate.getTime(),s="https://www.onlinelogomaker.com/applet_scripts/SaveUserData.php?",a=window.user.id||0
this.projectName=this.PROJECT_PREFIX+n
var i=this.projectName+".olmn",r=this.projectName+".dolmn",l=s+"user_id="+a+"&type=projects&name="+i,c=s+"user_id="+a+"&type=projects&name="+r,d=canvas.toJSON([]),p=document.getElementById("grid").backgroundColor
p&&(d.bgColor=p),d=JSON.stringify(d)
var h=JSON.stringify($canvas.children),g=void 0,u=!0,m=100,v=20
this.getProportionalCanvas(g,u,m,v).then(function(){$.ajax({type:"POST",url:l,dataType:"json",data:d,headers:{"Content-Type":"text/plain"},processData:!1}).then(function(e){}).fail(function(){}),$.ajax({type:"POST",url:c,dataType:"json",data:h,headers:{"Content-Type":"text/plain"},processData:!1}).then(function(e){}).fail(function(){})
var e=window.copy2ctx.canvas.toDataURL("png")
e=e.replace("data:image/png;base64,","")
var n=Base64Binary.decode(e,null)
$.ajax({type:"POST",url:l.replace(".olmn",".png"),dataType:"json",data:n,headers:{"Content-Type":"text/plain;charset=utf-8"},processData:!1}).then(function(e){t||(msg.send("open-popup"),msg.send("open-invalid-user-pass"),$("#saved-modal").show(),ga("send","event","App Click","Save Project","Saved project")),o.$scope.$apply()}).fail(function(){})})}},CanvasController.prototype.resetProjectName=function(){this.projectDate=new Date},CanvasController.prototype.touchedCanvas=function(){this.touched=!0},CanvasController.prototype.getRectBounds=function(e,t,o,n){for(var s,a,i=canvas.getWidth(),r=canvas.getHeight(),l=canvas.getContext().getImageData(0,0,i,r),c=l.data.length,d={top:null,left:null,right:null,bottom:null},p=0;p<c;p+=4)0!==l.data[p+3]&&(s=p/4%i,a=~~(p/4/i),null===d.top&&(d.top=a,e&&(d.top+=e)),null===d.left?(d.left=s,t&&(d.top+=t)):s<d.left&&(d.left=s,t&&(d.top+=t)),null===d.right?(d.right=s,o&&(d.right+=o)):d.right<s&&(d.right=s,o&&(d.right+=o)),null===d.bottom?(d.bottom=a+2,n&&(d.bottom+=o)):d.bottom<a&&(d.bottom=a+2,n&&(d.bottom+=o)))
return d},CanvasController}(),TransformController=function(){function e(t,o){this.$scope=t,this.$cmd=o,this.scaleTimeout,this.scaleTracker=[],this.precision=2,e.instance=this,canvas.on("object:moving",this.onObjectMove),canvas.on("object:scaling",this.onMouseChangeScale),canvas.on("object:selected",this.onObjectSelect),t.$watch("x",this.onChangePosition),t.$watch("y",this.onChangePosition),t.$watch("width",this.onChangeScale),t.$watch("height",this.onChangeScale),t.x=0,t.y=0,t.width=0,t.height=0}return e.prototype.onChangeScale=function(t){var o=e.instance,n=$canvas.getActiveDobj()
o.selected&&o.$scope.width&&o.$scope.height&&n.raw.set({scaleX:o.$scope.width/o.selected.width,scaleY:o.$scope.height/o.selected.height,originX:"center",originY:"center"})},e.prototype.onMouseChangeScale=function(t){var o=e.instance,n=$.extend(!0,{},$canvas.getActiveDobj()),s=$canvas.getActiveDobj(),a={x:n.raw.getScaleX(),y:n.raw.getScaleY(),l:n.raw.getLeft(),t:n.raw.getTop()},i={x:s.raw.getScaleX(),y:s.raw.getScaleY(),l:s.raw.getLeft(),t:s.raw.getTop()}
o.selected&&(o.scaleTracker.push(a),angular.isDefined(t)&&(clearTimeout(this.scaleTimeout),delete this.scaleTimeout,this.scaleTimeout=setTimeout(function(){o.$cmd.store("scale",s,o.scaleTracker[0],i),o.scaleTracker=[]},200)),setTimeout(function(){msg.send("draw-action-buttons",s.raw)},400))},e.prototype.onObjectSelect=function(t){var o=e.instance
o.selected=t.target},e.prototype.selectionCleared=function(t){var o=e.instance
setTimeout(function(){o.$scope.$apply()},100)},e.prototype.onObjectMove=function(t){var o=e.instance
o.$scope.x=t.target.get("left").toFloat(o.precision),o.$scope.y=t.target.get("top").toFloat(o.precision),setTimeout(function(){o.$scope.$apply()},100)},e.prototype.onObjectScale=function(t){var o=e.instance
o.$scope.width=(t.target.get("width")*t.target.scaleX).toFloat(o.precision),o.$scope.height=(t.target.get("height")*t.target.scaleY).toFloat(o.precision),setTimeout(function(){o.$scope.$apply()},100),o.onChangeScale(o)},e.prototype.onChangePosition=function(){var t=e.instance
null!==t.selected&&void 0!==t.selected&&(t.selected.set("left",t.$scope.x),t.selected.set("top",t.$scope.y),canvas.renderAll())},e}(),ShapesController=function(){function e(e,n){t=$(".object.add-geometry"),o=$(".leftpane .list-group-item.add-geometry"),this.$scope=e,this.$scope.$=this,this.$http=n,this.selectedCategory=1,this.selectedCategoryName="",this.selectedSymbol=0,this.symbolsUrl=[],this.currentIndex=0,this.sucessIndex=0,this.allCalls=[],this.loadedSymbols=!1,this.symbolsRootUrl="assets/",this.selectedSymbolUrl="",this.categories=data.categories,msg.on("on-esc-key-click",this.close,this),msg.on("open-symbols",this.close,this),msg.on("open-shapes",this.open,this),msg.on("load-shapes",this.load,this),this.htmlString=svgImg.stringToHtml(),$(document).mouseup(function(e){o.is(e.target)||t.show(),t.is(e.target)||0!==t.has(e.target).length||o.is(e.target)||t.hide()})}var t,o
return e.prototype.load=function(){var e=this
if(!e.loadedSymbols)return new Promise(function(t,o){e.$http.get("assets/list_shapes.json?v="+Math.floor(Date.now()/1e3)).then(function(o){e.$scope.$.categories=o.data,e.symbolsUrl=o.data[0],e.loadedSymbols=!0,t(e.loadedSymbols)})})},e.prototype.onEscKeyClick=function(){this.close()},e.prototype.open=function(){this.loadedSymbols?t.show():(glassLoader.start(),this.load().then(function(){t.show(),glassLoader.stop()}))},e.prototype.close=function(){this.abortCalls(),t.hide()},e.prototype.getShapes=function(){return this.symbolsUrl},e.prototype.onShapeClick=function(e,t){if($(".selected").removeClass("selected"),t.currentTarget.children.length>0)for(var o in t.currentTarget.children)t.currentTarget.children[o].className+=" selected"
this.selectedSymbol=e,this.onOkClick(),this.close()},e.prototype.getShapeData=function(){var e=this,t=e.currentIndex
if(!(t>=this.getShapes().length)){var o="assets/svg/geometric-forms/"+e.symbolsUrl[t]
e.currentIndex++,$.ajax({url:o,beforeSend:function(t,o){e.allCalls.push(t)},success:function(t){var n=(new XMLSerializer).serializeToString(t),s=encodeURIComponent(n),a="data:image/svg+xml;charset=utf8,"+s
$("#currimggeo"+e.sucessIndex.toString()).attr("src",a),$("#currimggeo"+e.sucessIndex.toString()).attr("meta",o),e.sucessIndex++},error:function(e,t){}})}},e.prototype.abortCalls=function(){$.each(_this.allCalls,function(e,t){t.abort()})},e.prototype.onCancelClick=function(){msg.send("close-popups")},e.prototype.onOkClick=function(){var e=$("#currimggeo"+this.selectedSymbol).attr("meta")
ga("send","event","App Click","Shape Select",e.toString()),this.abortCalls(),msg.send("add-symbol",e),msg.send("close-popups")},e}(),ShadowController=function(){function e(t,o){var n=this
this.$scope=t,this.$cmd=o,this.shadowEnabled=!1,this.glowEnabled=!1,this.strokeEnabled=!1,this.selectedObject=null,this.shadowColor="#FFFFFF",e.instance=this,t.$=this,t.shadowEnabled=!1,t.shadowEnabled=!1,t.strokeEnabled=!1,t.direction=45,t.outset=2,msg.on("object-selected",this.onObjectSelected,this),msg.on("paths-selected",this.onObjectSelected,this),msg.on("object-deselected",this.onObjectDeSelected,this),msg.on("deselect-all",this.onObjectDeSelected,this),t.$watch("direction",function(){return n.onChange()}),t.$watch("outset",function(){return n.onChange()}),$("[name='shadow-checkbox']").bootstrapSwitch({state:!1}),$(".object-option .options").hide(),$(".shadow-picker").mlColorPicker({onChange:function(e){n.onColorSelect(e)}}),$(".shadow-picker").click(function(e){$("#mlSelectedColorText").off(),$("#mlColors").off(),window.colorpicker.controller="ShadowController",window.colorpicker.visible=!0
var t=function(){n.onColorChange(this.value)},o=function(){var e,t=$canvas.getActiveDobj()
e="group"==t.raw.type?$canvas.getOriginColorByObj(t.raw,t.id.toString()+0):$canvas.getOriginColorByObj(t.raw,t.id),n.onColorChange(e.shadow.color)}
$("#mlSelectedColorText").on("keyup",t),$("#mlColors").on("mouseleave",o)})}return e.prototype.onColorChange=function(e){$(".shadow-picker").css("background-color","#"+e),$(".shadow-picker").val(e),this.resetColor(e)},e.prototype.onColorSelect=function(e){var t,o=$canvas.getActiveDobj(),n=o.shadow,s=e
if(e.indexOf(",")>-1){var a=rgba2rgb(e)
s=rgb2hex(a)}e.indexOf("#")==-1&&(s="#"+s),n.color=s,n.enabled=!0,"group"==o.raw.type?(t=$.extend(!0,{},$canvas.getOriginColorByObj(o.raw,o.id.toString()+0)),$canvas.setOriginShadowColor(o.raw,o.id.toString()+0,s)):(t=$.extend(!0,{},$canvas.getOriginColorByObj(o.raw,o.id)),$canvas.setOriginShadowColor(o.raw,o.id,s)),t.shadow.enabled=!0,$cmd.run("shadow",o,t.shadow,n),this.shadowColor=e},e.prototype.resetColor=function(e){var t=$canvas.getActiveDobj(),o=$.extend(!0,{},t.shadow),n=e
if(e.indexOf(",")>-1){var s=rgba2rgb(e)
n=rgb2hex(s)}e.indexOf("#")==-1&&(n="#"+n),o.color=n,$canvas.shadow(t,t.shadow,o),this.shadowColor=e},e.prototype.onObjectSelected=function(e){var t=this
if(this.$scope.shadowEnabled=e.shadow.enabled,this.$scope.glowEnabled=e.glow.enabled,$canvas.activePaths.length&&(this.$scope.strokeEnabled=null!=$canvas.activePaths[0].stroke),DomHelper.wrapOverlay("#shadow-pickr-container"),this.$scope.shadowEnabled){DomHelper.removeOverlay(),this.$scope.direction=e.shadow.direction,this.$scope.outset=e.shadow.outset
var o=e.shadow.color
if(o.indexOf(",")>-1){var n=rgba2rgb(o)
o=rgb2hex(n),o="#"+o}$(".shadow-picker").css("background-color",o),$(".shadow-picker").val(o)}setTimeout(function(){t.$scope.$apply()},20)},e.prototype.onObjectDeSelected=function(){this.$scope.shadowEnabled=!1,$(".shadow-picker").css("background-color","#ccc"),$(".shadow-picker").val("#ccc")},e.prototype.onChange=function(){var e=$canvas.children.length
if(e&&(e=$canvas.getActiveDobj(),this.$scope.shadowEnabled)){var t=$.extend(!0,{},e.shadow),o=this.$scope.direction/180*Math.PI
t.offsetX=Math.cos(o)*this.$scope.outset,t.offsetY=Math.sin(o)*this.$scope.outset,t.direction=this.$scope.direction,t.outset=this.$scope.outset,$cmd.run("shadow",e,e.shadow,t)}},e.prototype.showOption=function(e,t){$(".options").show(),$(".options > div").each(function(){$(this).hide()}),$(".effect-4 li.effect").each(function(){$(this).parent().removeClass("effect-active")}),$(".object-option .options "+t).show(),$(e.currentTarget).parent().addClass("effect-active")},e.prototype.onOnOffShadow=function(e){var t=$canvas.getActiveDobj(),o=$.extend(!0,{},t.shadow)
o.enabled=this.$scope.shadowEnabled,this.$scope.shadowEnabled?$(".shadow-position").removeAttr("disabled").css("color","black"):$(".shadow-position").attr("disabled","disabled").css("color","grey"),this.$scope.direction=45,this.$scope.outset=2,this.$scope.direction=t.shadow.direction,this.$scope.outset=t.shadow.outset,$cmd.run("shadow",t,t.shadow,o)
var n=o.color
o.color.indexOf("#")==-1&&(n=rgba2rgb(o.color),n="#"+rgb2hex(n)),$(".shadow-picker").css("background-color",n),$(".shadow-picker").val(n)},e.prototype.onOnOffGlow=function(){var e=$canvas.getActiveDobj(),t=$.extend(!0,{},e.glow)
t.enabled=this.$scope.glowEnabled,$cmd.run("glow",e,e.glow,t)},e.prototype.onOnOffStroke=function(e){var t=null,o="#000"
this.$scope.strokeEnabled||(o=null),$cmd.run("stroke",t,o)},e}(),AddTextController=function(){function e(e){this.$scope=e,e.text="",e.visible=!1,this.fontLoaded=!1,e.$=this,msg.on("open-addtext",this.open,this),msg.on("close-popups",this.close)}return e.prototype.open=function(){this.fontLoaded?(this.$scope.visible=!0,this.$scope.text=""):(msg.send("loadfont"),this.open())},e.prototype.close=function(){document.getElementById("downloadLogo-modal").style.display="none"},e.prototype.onCancelClick=function(){this.$scope.visible=!1,msg.send("close-popups")},e.prototype.onOkClick=function(e){e&&(this.$scope.text=Tools.translateText("Enter-a-text-text")),this.$scope.visible=!1,msg.send("add-text",this.$scope.text),msg.send("close-popups")},e}(),DownloadLogoController=function(){function DownloadLogoController($scope,$http){DownloadLogoController.instance=this
var thisRoot=this
this.$scope=$scope,this.lInstance=new LoginController($scope,$http,this),this.originCanvas={},this.originObjPosition={},this.originObjScale={},this.originBounds={},this.originWidth=0,this.originHeight=0,this.scaleRatioW=1,this.scaleRatioH=1,this.aspectRatioW=1,this.aspectRatioH=1,this.width=0,this.height=0,this.inputWidth=0,this.inputHeight=0,this.isPremium=!1,this.downloadInterval=null,this.percentageInterval=null,this.htmlWidth=$(".downloadLogo-modal .width"),this.htmlHeight=$(".downloadLogo-modal .height"),this.htmlShareModal=$("#share-modal"),this.constrainProportions=!0,this.useWorkingAreaColor=!1,$scope.text="",$scope.visible=!1,$scope.$=this,this.count=!0,msg.on("open-downloadlogo",this.prepare,this),msg.on("downloadlogo-prepared",this.open,this),msg.on("zip-complete",this.zipComplete,this),msg.on("download-complete",this.downloadComplete,this),msg.on("on-esc-key-click",this.onEscKeyClick,this),this.htmlWidth.bind("keyup mouseup",function(e){if(thisRoot.constrainProportions&&thisRoot.htmlWidth.val()>10){var t=Math.round(thisRoot.htmlWidth.val()*thisRoot.aspectRatioW)
thisRoot.height=t,thisRoot.htmlHeight.val(t)}}),this.htmlHeight.bind("keyup mouseup",function(e){if(thisRoot.constrainProportions&&thisRoot.htmlHeight.val()>10){var t=Math.round(thisRoot.htmlHeight.val()*thisRoot.aspectRatioH)
thisRoot.width=t,thisRoot.htmlWidth.val(t)}}),$scope.keys=[],$scope.keys.push({code:37,action:function(){}}),$scope.keys.push({code:39,action:function(){}}),$scope.$on("keydown",function(e,t){var o=t.code
$scope.keys.forEach(function(e){e.code===o&&(e.action(),$scope.$apply())})}),null==eval(window.localStorage.getItem("downloadCounter"))&&window.localStorage.setItem("downloadCounter",0)}return DownloadLogoController.prototype.setDownloadProportions=function(){$canvas.selectAll(),this.inputWidth=this.htmlWidth.val(),this.inputHeight=this.htmlHeight.val(),this.scaleRatioW=this.inputWidth/this.originWidth,this.scaleRatioH=this.inputHeight/this.originHeight,canvas.setWidth(canvas.width+this.width),canvas.setHeight(canvas.height+this.height),document.getElementById("grid").width=canvas.getWidth(),document.getElementById("grid").height=canvas.getHeight(),$canvas.getActiveGroup().set({scaleX:this.scaleRatioW,scaleY:this.scaleRatioH,left:canvas.width/2,top:canvas.height/2,originX:"center",originY:"center"})},DownloadLogoController.prototype.downloadLogoPopup=function(){var e=Tools.getQueryParameters("s")
window.logged?msg.send("open-popup","downloadlogo"):"1"===e?(msg.send("toggle-register"),msg.send("open-popup"),window.flag=!0,window.fromDownload=!0,$("#register-btn").text(Tools.translateText("download-text")),$("#login-btn").text(Tools.translateText("download-text")),$("#save-modal").show()):"2"===e?(msg.send("toggle-login"),window.flag=!1,msg.send("open-popup"),window.fromDownload=!0,$("#register-btn").text(Tools.translateText("download-text")),$("#login-btn").text(Tools.translateText("download-text")),$("#save-modal").show()):"3"===e?(msg.send("toggle-register"),window.flag=!0,msg.send("open-popup"),window.fromDownload=!0,$("#register-btn").text(Tools.translateText("download-text")),$("#login-btn").text(Tools.translateText("download-text")),$("#save-modal").show()):"4"===e?(msg.send("toggle-login"),window.flag=!1,msg.send("open-popup"),window.fromDownload=!0,$("#register-btn").text(Tools.translateText("download-text")),$("#login-btn").text(Tools.translateText("download-text")),$("#save-modal").show()):"5"===e?($("#remember-me-check-box").is(":checked")?(msg.send("toggle-login"),window.flag=!1):(msg.send("toggle-register"),window.flag=!0),msg.send("open-popup"),window.fromDownload=!0,$("#register-btn-2").text(Tools.translateText("download-text")),$("#login-btn-2").text(Tools.translateText("download-text")),$("#save-modal-2").show()):"6"===e?(msg.send("toggle-login"),window.flag=!1,msg.send("open-popup"),window.fromDownload=!0,$("#register-btn-2").text(Tools.translateText("download-text")),$("#login-btn-2").text(Tools.translateText("download-text")),$("#save-modal-2").show()):"7"===e?(window.flag=!0,msg.send("open-popup","downloadlogo")):(msg.send("toggle-login"),msg.send("open-popup"),window.fromDownload=!0,$("#register-btn-2").text(Tools.translateText("download-text")),$("#login-btn-2").text(Tools.translateText("download-text")),$("#save-modal-2").show())},DownloadLogoController.prototype.prepare=function(){msg.send("prepare-canvas-size","downloadlogo-prepared")},DownloadLogoController.prototype.open=function(){var e=this
if("block"!=$("#downloadLogo-modal").css("display")){$canvas.selectAll(),this.originCanvas=window.copy2ctx.canvas
var t=$.extend(!0,{},$canvas.getActiveGroup())
this.originObjPosition={left:t.left,top:t.top},this.originObjScale={scaleX:t.getScaleX(),scaleY:t.getScaleY()},this.$scope.visible=!0,this.$scope.text="",document.getElementById("downloadLogo-modal").style.display="block",this.width=Math.round(this.originCanvas.width),this.height=Math.round(this.originCanvas.height),this.originWidth=this.width,this.originHeight=this.height,this.htmlWidth.val(this.width),this.htmlHeight.val(this.height),this.aspectRatioW=this.height/this.width,this.aspectRatioH=this.width/this.height,this.lInstance.loginPromise().then(function(){window.logged?$.ajax({type:"POST",url:"https://www.onlinelogomaker.com/applet_scripts/isPremium.php",data:{id:window.user.id},success:function(t){var o=parseInt(t)
o?(ga("send","event","App Click","Download Logo","Premium Download"),e.preparePremiumDownload()):(ga("send","event","App Click","Download Logo","Free Download"),e.prepareFreeDownload())}}).fail(function(){}):(ga("send","event","App Click","Download Logo","Free Download"),e.prepareFreeDownload())})}},DownloadLogoController.prototype.percentageLoader=function(e){var t=this
clearInterval(t.percentageInterval),void 0==e&&(e=10),glassLoader.start(),this.disabledButtons(!0)
var o=0
this.percentageInterval=setInterval(function(){o+=1,o=Math.round(o),o>=100&&(o=100,clearInterval(t.percentageInterval)),$(".downloadLogo-modal .download-info").text(Tools.translateText("please-wait-text")+o+"%").css("color","black"),$(".progress-bar").css("width",o+"%")},e)},DownloadLogoController.prototype.stopPercentageLoader=function(){clearInterval(this.percentageInterval),clearTimeout(this.percentageInterval)},DownloadLogoController.prototype.resetPercentageLoader=function(){$(".downloadLogo-modal .download-info").text(Tools.translateText("please-wait-text")+" 100%").css("color","black"),$(".progress-bar").css("width","100%"),clearTimeout(this.percentageInterval),$(".downloadLogo-modal .download-info").text(Tools.translateText("logo-ready-text")).css("color","white")},DownloadLogoController.prototype.preparePremiumDownload=function(){var e=this
window.downloadFiles=[],this.percentageLoader(30),e.downloadInterval=setTimeout(function(){e.useWorkingAreaColor=!1,e.width=2e3,e.height=Math.round(e.width*e.aspectRatioW),e.htmlWidth.val(e.width),e.htmlHeight.val(e.height),e.downloadInterval=setTimeout(function(){canvas.deactivateAllWithDispatch().renderAll(),msg.send("deselect-all"),e.download(isPremium=!0,download=!1),e.downloadInterval=setTimeout(function(){e.useWorkingAreaColor=!0,e.downloadInterval=setTimeout(function(){e.download(isPremium=!0,download=!1),e.downloadInterval=setTimeout(function(){e.useWorkingAreaColor=!1,e.width=500,e.height=Math.round(e.width*e.aspectRatioW),e.htmlWidth.val(e.width),e.htmlHeight.val(e.height),e.downloadInterval=setTimeout(function(){canvas.deactivateAllWithDispatch().renderAll(),msg.send("deselect-all"),e.stopPercentageLoader(),e.download(isPremium=!0,download=!0),e.downloadInterval=setTimeout(function(){setCanvasDimensions(),$cmd.run("background-color",$oCanvasColor.current,$oCanvasColor.current)},100)},100)},500)},300)},100)},100)},1500)},DownloadLogoController.prototype.prepareFreeDownload=function(){var e=this
window.downloadFiles=[],this.percentageLoader(6),e.downloadInterval=setTimeout(function(){e.useWorkingAreaColor=!1,e.width=300,e.height=Math.round(e.width*e.aspectRatioW),e.htmlWidth.val(e.width),e.htmlHeight.val(e.height),e.downloadInterval=setTimeout(function(){canvas.deactivateAllWithDispatch().renderAll(),msg.send("deselect-all"),e.stopPercentageLoader(),e.download(isPremium=!1,download=!0),e.downloadInterval=setTimeout(function(){setCanvasDimensions(),$cmd.run("background-color",$oCanvasColor.current,$oCanvasColor.current)},100)},100)},300)},DownloadLogoController.prototype.resetProportions=function(){$canvas.selectAll(),$canvas.getActiveGroup().set({scaleX:1/this.scaleRatioW,scaleY:1/this.scaleRatioH,left:this.originObjPosition.left,top:this.originObjPosition.top,originX:"center",originY:"center"}),canvas.renderAll(),setTimeout(function(){canvas.deactivateAllWithDispatch().renderAll()},300)},DownloadLogoController.prototype.close=function(){this.$scope.visible=!1,msg.send("close-popups"),this.resetProportions()},DownloadLogoController.prototype.onCancelClick=function(){this.scaleRatioW=1,this.scaleRatioH=1,this.close()},DownloadLogoController.prototype.onPngOkClick=function(){var e=this
setTimeout(function(){e.width=500,e.useWorkingAreaColor=!0,e.height=Math.round(e.width*e.aspectRatioW),e.htmlWidth.val(e.width),e.htmlHeight.val(e.height),setTimeout(function(){canvas.deactivateAllWithDispatch().renderAll(),msg.send("deselect-all"),e.download(isPremium=!1)},500)},500)},DownloadLogoController.prototype.onSvgOkClick=function(){},DownloadLogoController.prototype.onEscKeyClick=function(){this.htmlShareModal.hide()},DownloadLogoController.prototype.validate=function(){var e=!0,t=""
return this.inputWidth=this.htmlWidth.val(),this.inputHeight=this.htmlHeight.val(),0==this.inputWidth.length&&0==this.inputHeight.length?(e=!1,t="Please enter the desired width and height for your download."):0==this.inputWidth.length?(e=!1,t="Please enter the desired width for your download."):0==this.inputHeight.length&&(e=!1,t="Please enter the desired height for your download."),this.inputWidth.length>5&&(e=!1,t="Maximum width and height allowed for download is: 5000px"),this.inputHeight.length>5&&(e=!1,t="Maximum width and height allowed for download is: 5000px"),e||alert(t),e},DownloadLogoController.prototype.download=function(isPremium,download){var _this=this
if(this.isPremium=isPremium,this.validate()){this.setDownloadProportions(),this.$scope.visible=!1
var padding=20
msg.send("download-canvas",_this.constrainProportions,_this.useWorkingAreaColor,widthPadding=padding,heightPadding=padding,_this.inputWidth,_this.inputHeight,_this.scaleRatioW,_this.scaleRatioH,_this.isPremium,download)}var downloadCounter=eval(window.localStorage.getItem("downloadCounter"))
downloadCounter+=1,window.localStorage.setItem("downloadCounter",downloadCounter)},DownloadLogoController.prototype.disabledButtons=function(e){$(".downloadLogo-modal .body .popup-footer a").each(function(){$(this).attr("disabled",e)}),$(".downloadLogo-modal .body .popup-footer button").each(function(){$(this).attr("disabled",e)}),$("#tools-download-button").attr("disabled",e)},DownloadLogoController.prototype.downloadInprogress=function(){},DownloadLogoController.prototype.downloadComplete=function(){this.resetProportions()},DownloadLogoController.prototype.zipComplete=function(){this.disabledButtons(!1),this.resetPercentageLoader()},DownloadLogoController.prototype.downloadCanceled=function(){clearTimeout(this.downloadInterval),clearTimeout(this.percentageInterval),$("#dlink").replaceWith('<a id="dlink" target="_blank" style="display: inline-block;">'+Tools.translateText("wait-text")+"</a>")
var e=document.getElementById("wrapperImg")
if(e){var t=document.getElementById("downloadImg"),o=e.parentNode
t.src="img/cloud2.png",o.replaceChild(t,e)}this.disabledButtons(!1),$(".downloadLogo-modal .download-info").text(""),canvas.deactivateAllWithDispatch().renderAll(),setCanvasDimensions(),glassLoader.stop(),$("#mask").hide(),$cmd.run("background-color",$oCanvasColor.current,$oCanvasColor.current),this.count&&this.htmlShareModal.show(),this.count=!1},DownloadLogoController}(),NewLogoController=function(){function e(t){e.instance=this,this.$scope=t,t.$=this}return e.prototype.onOkClick=function(){$canvas.removeAll(),ga("send","event","App Click","New Button","New Button Clicked"),msg.send("reset-project-name"),msg.send("clear-history"),msg.send("touchedCanvas"),msg.send("on-grid-click",!1,disable=!0),msg.send("set-background-color","#ffffff","#ffffff"),$(".background-picker div").css("background-color","#ffffff")},e.prototype.onCloseClick=function(){},e}(),ModifyController=function(){function e(e,t){this.$scope=e,this.$cmd=t,this.step=2,this.factor=1.01,this.angle=2,e.$=this}return e.prototype.moveUp=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&this.$cmd.run("move",e,0,-2)},e.prototype.moveDown=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&this.$cmd.run("move",e,0,2)},e.prototype.moveLeft=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&this.$cmd.run("move",e,-2,0)},e.prototype.moveRight=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&this.$cmd.run("move",e,2,0)},e.prototype.zoomIn=function(){var e=$.extend(!0,{},$canvas.getActiveDobj()),t=$canvas.getActiveDobj(),o={x:e.raw.getScaleX(),y:e.raw.getScaleY()},n={x:this.factor*t.raw.getScaleX(),y:this.factor*t.raw.getScaleY()}
this.$cmd.run("scale",t,o,n,t.raw.left,t.raw.top)},e.prototype.zoomOut=function(){var e=$.extend(!0,{},$canvas.getActiveDobj()),t=$canvas.getActiveDobj(),o={x:e.raw.getScaleX(),y:e.raw.getScaleY()},n={x:1/this.factor*obj.getScaleX(),y:1/this.factor*obj.getScaleY()}
this.$cmd.run("scale",t,o,n,t.raw.left,t.raw.top)},e.prototype.rotateCW=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&$cmd.run("rotate",e,this.angle)},e.prototype.rotateCCW=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&$cmd.run("rotate",e,-this.angle)},e.prototype.duplicate=function(){$cmd.run("duplicate")},e}(),LoginController=function(){function e(e,t){this.$scope=e,this.$http=t,this.$scope.$=this,this.GET_USER_URL="https://www.onlinelogomaker.com/applet_scripts/GetUser.php",this.LOGIN_URL="https://www.onlinelogomaker.com/applet_scripts/DoLogin.php",this.LOGIN_URL="https://www.onlinelogomaker.com/applet_scripts/DoLogin.php",this.REGISTER_USER="https://www.onlinelogomaker.com/applet_scripts/RegisterFreeUser.php",this.LOGOUT_URL="https://www.onlinelogomaker.com/applet_scripts/DoLogout.php",this.registering=!1,e.fromDownload=!1,e.rememberCheck=!1,e.logged=!1,e.isPremium=!1,window.flag=!0,window.logged=!1,window.user={},t.defaults.headers.common["Access-Control-Allow-Headers"]="*",$("#olm-login-area").click(function(){msg.send("remove-opacity-all"),canvas.discardActiveObject()})
var o=Tools.getCookie("useremail")
""!=o?($("#remember-me-check-box").attr("checked",!0),this.$scope.username=o):$("#remember-me-check-box").attr("checked",!1),msg.on("toggle-login",this.toggleLogin),msg.on("toggle-register",this.toggleRegister)}return e.prototype.init=function(){var e=(new validator(this.$scope.username),new validator(this.$scope.password),this)
$.post(this.GET_USER_URL,{username:this.$scope.username,password:this.$scope.password},function(t,o){var n=JSON.parse(xml2json(t,""))
try{n.root.user.id==-1?(e.$scope.logged=!1,window.logged=!1,e.$scope.isPremium=!1,e.$scope.$apply(),$(".sk-circle").hide(),$("#error-text").hide()):(e.$scope.userfullname=n.root.user.name,e.$scope.user=n.root.user,e.$scope.logged=!0,$(".sk-circle").hide(),$("#error-text").hide(),window.logged=!0,window.user=n.root.user,e.$scope.isPremium=e.userIsPremium(),setTimeout(function(){e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname)},1e3))}catch(e){console.error(e)}},"xml")},e.prototype.loginPromise=function(){var e=this
new validator(this.$scope.username),new validator(this.$scope.password)
return new Promise(function(t,o){void 0==this.GET_USER_URL&&(this.GET_USER_URL="https://www.onlinelogomaker.com/applet_scripts/GetUser.php"),$.post(this.GET_USER_URL,{username:e.$scope.username,password:e.$scope.password},function(o,n){var s=JSON.parse(xml2json(o,""))
try{s.root.user.id==-1?(e.$scope.logged=!1,window.logged=!1,e.$scope.$apply()):(e.$scope.userfullname=s.root.user.name,e.$scope.user=s.root.user,e.$scope.logged=!0,window.logged=!0,window.user=s.root.user,e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname)),t(1)}catch(e){console.error(e),t(0)}},"xml")})},e.prototype.fakeLoginPromise=function(){return new Promise(function(e,t){e(1)})},e.prototype.enterOnModal=function(){window.flag?this.onRegisterClick():this.onLoginClickModal()},e.prototype.onLoginClick=function(){var e=this,t=!1,o=""
$(".auth-content").html("")
new validator(this.$scope.username),new validator(this.$scope.password)
return"undefined"!=typeof this.$scope.password?0==this.$scope.password.length&&(t=!0,o=Tools.translateText("enter-password-text")):(t=!0,o=Tools.translateText("enter-password-text")),"undefined"!=typeof this.$scope.username?0==this.$scope.username.length&&(t=!0,o=Tools.translateText("enter-user-text")):(t=!0,o=Tools.translateText("enter-user-text")),t?($("#error-text").show(),void $("#error-text").text(o)):($(".sk-circle").show(),$("#error-text").hide(),void $.post(this.LOGIN_URL,{username:this.$scope.username,password:this.$scope.password},function(t,o){var n=JSON.parse(xml2json(t,""))
n.error?(msg.send("open-popup"),msg.send("open-invalid-user-pass"),$("#error-text").show(),$("#error-text").text("Invalid username or password."),e.$scope.logged=!1,e.$scope.isPremium=!1,e.$scope.$apply(),ga("send","event","App Click","Login button clicked","Login failed"),window.logged=!1):n.root&&(e.$scope.userfullname=n.root.user.name,e.$scope.logged=!0,window.logged=!0,window.user=n.root.user,e.$scope.isPremium=e.userIsPremium(),ga("send","event","App Click","Login button clicked","Login sucessful"),$("#remember-me-check-box").is(":checked")&&Tools.createCookie("useremail",e.$scope.username.toString(),500),e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname),msg.send("save-project-popup"))},"xml"))},e.prototype.onLoginClickModal=function(){var e=this,t=!1,o=""
$(".auth-content").html("")
new validator(this.$scope.username),new validator(this.$scope.password)
return"undefined"!=typeof this.$scope.password?0==this.$scope.password.length&&(t=!0,o=Tools.translateText("enter-password-text")):(t=!0,o=Tools.translateText("enter-password-text")),"undefined"!=typeof this.$scope.username?0==this.$scope.username.length&&(t=!0,o=Tools.translateText("enter-user-text")):(t=!0,o=Tools.translateText("enter-user-text")),t?($("#error-text").show(),void $("#error-text").text(o)):($(".sk-circle").show(),$("#error-text").hide(),void $.post(this.LOGIN_URL,{username:this.$scope.username,password:this.$scope.password},function(t,o){var n=JSON.parse(xml2json(t,""))
n.error?(msg.send("open-popup"),msg.send("open-invalid-user-pass"),$(".sk-circle").hide(),$("#error-text").show(),$("#error-text").text("Invalid username or password."),ga("send","event","App Click","Login button clicked","Login failed"),e.$scope.logged=!1,e.$scope.isPremium=!1,e.$scope.$apply(),window.logged=!1):n.root&&(e.$scope.userfullname=n.root.user.name,e.$scope.logged=!0,window.logged=!0,window.user=n.root.user,e.$scope.isPremium=e.userIsPremium(),ga("send","event","App Click","Login button clicked","Login sucessful"),$("#remember-me-check-box").is(":checked")&&Tools.createCookie("useremail",e.$scope.username.toString(),500),e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname),$("#save-modal").hide(),$("#save-modal-2").hide(),$(".sk-circle").hide(),window.fromDownload?(msg.send("open-popup","downloadlogo"),msg.send("save-project",!0,!0)):msg.send("save-project-popup",!0,!1))},"xml"))},e.prototype.registerButton=function(){msg.send("close-popups"),msg.send("open-popup"),window.fromDownload=!1
var e=Tools.getQueryParameters("s")
"1"!==e&&"2"!==e&&"3"!==e&&"4"!==e||$("#save-modal").show(),"5"===e||"6"===e||"7"===e?$("#save-modal-2").show():$("#save-modal-2").show(),this.toggleRegister()},e.prototype.onRegisterClick=function(){var e=this
if(!this.registering){var e=this,t=!1,o=""
$(".auth-content").html("")
new validator(this.$scope.userfullname),new validator(this.$scope.username),new validator(this.$scope.password)
if("undefined"!=typeof this.$scope.userfullname?0==this.$scope.userfullname.length&&(t=!0,o="Enter your name"):(t=!0,o="Enter your name"),"undefined"!=typeof this.$scope.password?0==this.$scope.password.length&&(t=!0,o=Tools.translateText("enter-password-text")):(t=!0,o=Tools.translateText("enter-password-text")),"undefined"!=typeof this.$scope.username?0==this.$scope.username.length&&(t=!0,o=Tools.translateText("enter-user-text")):(t=!0,o=Tools.translateText("enter-user-text")),Tools.validateEmail(this.$scope.username)||(t=!0,o="Invalid user email format!"),t)return $("#error-text").show(),void $("#error-text").text(o)
var e=this
$(".sk-circle").show(),$("#error-text").hide(),$.post("/register",{"form[username]":this.$scope.userfullname,"form[email]":this.$scope.username,"form[password]":this.$scope.password,"form[formId]":"4"},function(t,o,n){var s=t.search("account")
if(s>=0)ga("send","event","App Click","Register button clicked","Registration successful"),$(".sk-circle").hide(),$("#save-modal").hide(),$("#save-modal-2").hide(),e.registering=!1,e.$scope.logged=!0,window.logged=!0,window.user=e.$scope.userfullname,$("#remember-me-check-box").is(":checked")&&Tools.createCookie("useremail",e.$scope.username.toString(),500),e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname),window.fromDownload?(msg.send("save-project",!0,!0),msg.send("open-popup","downloadlogo")):msg.send("save-project",!0,!1)
else{var a=t.search("This email is already registered."),i="Something went wrong, please check your information"
a>=0&&(i="Email already registered"),ga("send","event","App Click","Register button clicked","Error User Registration"),$(".sk-circle").hide(),e.registering=!1,$("#error-text").show(),$("#error-text").text(i)}})}},e.prototype.toggleLogin=function(){var e=Tools.getQueryParameters("s")
$("#error-text").hide(),$("#fullname-placeholder-text").hide(),$("#fullname-placeholder-text-2").hide(),$("#forgot-text").show(),$("#register-btn").hide(),$("#login-btn").show(),$("#register-btn-2").hide(),$("#login-btn-2").show(),window.fromDownload?$("#login-btn").text(Tools.translateText("download-text")):($("#login-btn").text(Tools.translateText("login-btn")),$("#login-btn-2").text(Tools.translateText("login-btn"))),"4"===e||"3"===e||"5"===e||"6"===e||"7"===e?($("#create-account-text").text(Tools.translateText("sign-in-text-alt")),$("#create-account-text-2").text(Tools.translateText("sign-in-text-alt")),$("#click-log-in-text").text(Tools.translateText("sign-up-free-alt")),$("#click-log-in-text-2").text(Tools.translateText("sign-up-free-alt"))):($("#click-log-in-text").text(Tools.translateText("sign-up-free")),$("#create-account-text").text(Tools.translateText("sign-in-text")),$("#create-account-text-2").text(Tools.translateText("sign-in-text")),$("#click-log-in-text-2").text(Tools.translateText("sign-up-free")),$("#click-log-in-text-2").text(Tools.translateText("sign-up-free-alt"))),$("#have-account-text").text(Tools.translateText("dont-have-an-account-text")),window.flag=!1},e.prototype.toggleRegister=function(){var e=Tools.getQueryParameters("s")
$("#error-text").hide(),$("#forgot-text").hide(),$("#fullname-placeholder-text").show(),$("#fullname-placeholder-text-2").show(),$("#register-btn").show(),$("#login-btn").hide(),$("#register-btn-2").show(),$("#login-btn-2").hide(),window.fromDownload?$("#register-btn").text(Tools.translateText("download-text")):($("#register-btn").text(Tools.translateText("register-btn")),$("#register-btn-2").text(Tools.translateText("register-btn"))),$("#have-account-text").text(Tools.translateText("have-account-text")),"4"===e||"3"===e||"5"===e||"6"===e?($("#click-log-in-text-2").text(Tools.translateText("click-log-in-text")),$("#create-account-text").text(Tools.translateText("create-account-text-alt")),$("#create-account-text-2").text(Tools.translateText("create-account-text-alt")),$("#click-log-in-text").text(Tools.translateText("click-log-in-text"))):($("#click-log-in-text").text(Tools.translateText("click-log-in-text")),$("#create-account-text-2").text(Tools.translateText("create-account-text")),$("#create-account-text").text(Tools.translateText("create-account-text")),$("#click-log-in-text-2").text(Tools.translateText("click-log-in-text"))),window.flag=!0},e.prototype.onToggleRegistration=function(){var e=this
window.flag?e.toggleLogin():e.toggleRegister()},e.prototype.onBecomePremiumClick=function(){open(Tools.translateText("olm-become-premium-url"),"_blank")},e.prototype.onCloseClick=function(){var e=this
window.fromDownload=!1,$("#error-text").hide(),$("#sk-circle").hide(),$("save-modal").hide(),$("#save-modal-2").hide(),$("#logged-in-modal").hide(),e.$scope.userfullname="",e.$scope.username="",e.$scope.password=""},e.prototype.onLogoutClick=function(){var e=this
$.post(this.LOGOUT_URL,function(t,o){e.$scope.logged=!1,e.$scope.user=null,e.$scope.isPremium=!1,e.$scope.userfullname="",e.$scope.username="",e.$scope.password="",e.$scope.$apply(),window.logged=!1,window.user={}}),$(".sk-circle").hide(),$("#error-text").hide()},e.prototype.onAccountClick=function(){open(Tools.translateText("my-account-url-text"),"_blank")},e.prototype.onFacebookClick=function(){open("https://www.facebook.com/sharer/sharer.php?s=100&p[url]=http://bit.ly/6ljInp&p[images][0]=http://www.onlinelogomaker.com/images/favicon-cropped128.png&p[title]=Create+your+own+logo+for+free&p[summary]=Create%20your%20own%20logo%20now%20using%20Online%20Logo%20Maker!","_blank")},e.prototype.onTwitterClick=function(){open("https://twitter.com/intent/tweet?original_referer=&source=tweetbutton&text=RT+Create+cool+logos+for+free!&url=http://www.onlinelogomaker.com/&via=rlopes528","_blank")},e.prototype.onOkClick=function(){this.$scope.visible=!1,$("#id-auth").hide(),msg.send("close-popups")},e.prototype.setMenuTexts=function(e){$("#welcome-user-text").text()
$("#welcome-user-text").text(Tools.translateText("welcome-user-text")+", "+e),$("#my-account-menu-text").text(Tools.translateText("my-account-menu-text")),$("#logout-text").text(Tools.translateText("logout-text")),$("#free-account-text").text(Tools.translateText("free-account-text")),$("#olm-become-premium-button").text(Tools.translateText("olm-become-premium-button"))},e.prototype.userIsPremium=function(){return"1"===window.user.premium_status},e}(),ObjectsController=function(){function e(t){var o=this
this.$scope=t,this.items=[],this.selectedIndex=-1,e.instance=this,t.$=this,msg.on("object-added",this.onObjectAdd,this),msg.on("object-selected",this.onObjectSelected,this),msg.on("object-move-up",this.onObjectMoveUp,this),msg.on("object-move-down",this.onObjectMoveDown,this),msg.on("object-single-delete",this.onDeleteClick,this),msg.on("object-multiple-delete",this.onDeleteAllClick,this),msg.on("deselect-all",this.clearSelection,this),t.items=$canvas.children,t.sortableOptions={start:function(e,t){o.selectItem(t.item.sortable.index)},containment:"window",stop:function(e,t){for(var o=$canvas.children.length-1;o>=0;o--)$canvas.children[o].raw.moveTo($canvas.children.length-o)}}}return e.prototype.onObjectMoveUp=function(e){for(var t=0;t<$canvas.children.length;t++)if($canvas.children[t].selected&&t>0){$canvas.children.move(t,t-1),canvas.getActiveObject().moveTo($canvas.getObjZindex($canvas.getActiveObj())+1)
break}},e.prototype.onObjectMoveDown=function(e){for(var t=0;t<$canvas.children.length;t++)if($canvas.children[t].selected&&t<$canvas.children.length-1){$canvas.children.move(t,t+1),canvas.getActiveObject().moveTo($canvas.getObjZindex($canvas.getActiveObj())-1)
break}},e.prototype.selectItem=function(e){$canvas.select($canvas.children[e])},e.prototype.onItemClick=function(e){this.selectItem(e)},e.prototype.onItemDoubleClick=function(e,t){msg.send("open-popup","rename")},e.prototype.onObjectAdd=function(e){var t=new DisplayObject
t.raw=e,this.items.unshift(t),t.name="OBJECT "+this.items.length,this.selectObject(e,!0)},e.prototype.onMoveUpClick=function(){this.onObjectMoveUp(this)},e.prototype.onMoveDownClick=function(){this.onObjectMoveDown(this)},e.prototype.selectObject=function(e,t){for(var o=-1,n=0;n<$canvas.children.length;n++)$canvas.children[n].selected=!1,$canvas.children[n].raw==e.raw&&($canvas.children[n].selected=t,o=n)},e.prototype.onObjectSelected=function(t){if(canvas.getObjects().length<=1)$("#id-zindex-buttonbar").hide()
else{var o=canvas.getActiveObject(),n=canvas.getObjects().indexOf(o),s=0===n,a=n==canvas.getObjects().length-1
$("#id-zindex-buttonbar").show(),$("#id-bringforward-btn").prop("disabled",a),$("#id-sendbackwards-btn").prop("disabled",s),$("#bring-forward-btn").prop("disabled",s),$("#send-backwards-btn").prop("disabled",a)}e.instance
this.selectObject(t,!0),this.update()},e.prototype.onSelectionCleared=function(e){_this.selectObject(e.target,!1),scopeApply(_this.$scope)},e.prototype.clearSelection=function(){},e.prototype.update=function(){for(var e=canvas.getActiveObject(),t=0;t<this.items.length;t++)this.items[t].selected=this.items[t].raw==e
var o=canvas.getActiveGroup()
if(o){var n=o.getObjects()
for(t=0;t<n.length;t++)this.selectObject(n[t],!0)}},e.prototype.onRenameClick=function(){msg.send("open-popup","rename")},e.prototype.removeObj=function(){msg.send("remove-object")},e.prototype.onDeleteClick=function(){this.removeObj()},e.prototype.removeAllObj=function(){msg.send("remove-objects")},e.prototype.onDeleteAllClick=function(){this.removeAllObj()},e}(),PopupController=function(){function e(e){this.id="",this.$scope=e,e.$=this,e.visible=!1,$("#id-auth").hide()}return e.prototype.init=function(e){this.id=e,msg.on("open-"+e,this.open,this),msg.on("close-"+e,this.open,this)},e.prototype.open=function(){this.$scope.visible=!0},e.prototype.close=function(){this.$scope.visible=!1,msg.send("close-popups")},e}(),ConfirmationController=function(e){function t(t){e.call(this,t),msg.on("open-confirmation",this.open,this)}return __extends(t,e),t.prototype.open=function(){this.$scope.visible=!0,this.$scope.text="",document.getElementById("confirmation-modal").style.display="block"},t.prototype.onYesClick=function(){this.close(),msg.send("confirmation-clicked",!0)},t.prototype.onNoClick=function(){this.close(),msg.send("confirmation-clicked",!1)},t}(PopupController),FontSelectionController=function(e){function t(t){e.call(this,t)
var o=this
this.items=[],this.normalFonts=[],this.originFont="ADAMCG PRO",this.currentIndex=0,this.$scope=t,t.$=this,msg.on("object-selected",this.onObjectSelected,this),$(".dropdown").click(function(){o.currentIndex=0}),t.keys=[],t.keys.push({code:38,action:function(){o.currentIndex>=0&&(o.currentIndex>0&&o.currentIndex--,o.onItemPreview(o.currentIndex))}}),t.keys.push({code:40,action:function(){o.currentIndex<o.items.length-1&&(o.currentIndex++,o.onItemPreview(o.currentIndex))}}),t.$on("keydown",function(e,o){var n=o.code
t.keys.forEach(function(e){e.code===n&&(e.action(),t.$apply())})}),$.get("assets/fonts/fonts.json?v="+Math.floor(Date.now()/1e3),function(){}).always(function(e){e.hasOwnProperty("normalFonts")&&(o.normalFonts=e.normalFonts),o.init("fontselection"),o.generateFontFaces()})}return __extends(t,e),t.prototype.generateFontFaces=function(){for(var e,t=document.createElement("style"),o=".eot",n=0;n<this.normalFonts.length;n++){e=this.normalFonts[n],this.items.push({name:this.normalFonts[n]})
var s=/Trident/
s.test(window.navigator.userAgent)||(o=".ttf"),t.appendChild(document.createTextNode("                @font-face {                    font-family: '"+e+"';                    src: url('assets/fonts/"+e+o+"') format('truetype');                    text-rendering: optimizeLegibility;                    speak: none;                    font-style: normal;                    font-weight: normal;                    font-variant: normal;                    text-transform: none;                    line-height: 1;                    -webkit-font-smoothing: antialiased;                }            "))}document.head.appendChild(t)},t.prototype.onItemClick=function(e,t){this.currentIndex=e
var o,n,s,a,i=$(t.currentTarget).siblings()
o=$canvas.getActiveDobj(),s=$.extend(!0,{},o),n=this.items[e].name,a=s.font
for(var r=0;r<i.length;r++)i[r].style.backgroundColor=""
this.originFont=n,o.font=n,t.currentTarget.style.backgroundColor="#eee",$cmd.run("text-font",a,n)},t.prototype.onItemPreview=function(e){var t,o,n,s
t=$canvas.getActiveDobj(),n=$.extend(!0,{},t),o=this.items[e].name,s=n.raw.fontFamily,msg.send("text-font",s,o)},t.prototype.onItemReset=function(){msg.send("text-font",this.originFont,this.originFont)},t.prototype.onOkClick=function(){this.close()},t.prototype.onCancelClick=function(){this.close()},t.prototype.onObjectSelected=function(e){e.type==DOType.ITEXT&&(e.font=e.raw.fontFamily)},t}(PopupController),TextController=function(){function e(t){var o=this
this.$scope=t,this.textcolorTracker=[],ObjectsController.instance=this,e.instance=this,this.primaryColor=void 0,this.primaryColorWasSet=!1,this.primaryColorWasStored=!1,this.oldColor="fff",this.newColor="fff",t.$=this,t.visible=!1,t.font_name="",msg.on("object-selected",this.onObjectSelected,this),msg.on("object-deselected",this.onObjectDeSelected,this),msg.on("deselect-all",this.onObjectDeSelected,this),msg.on("update-text-font",this.fontSelect,this),msg.on("object-bringforward",this.bringForward,this),msg.on("object-sendbackwards",this.sendBackwards,this),msg.on("submit-undo",this.colorUndo,this),$("#colorpicker-holder-text").ColorPicker({flat:!0,onChange:function(e,t,n,s){o.onColorChange(t)},onSubmit:function(e,t,n,s){$.isEmptyObject($canvas.getActiveObj())||o.onColorSelect(t)}}),$("#colorpicker-holder-text").hide(),$(".text-picker").keyup(function(){$(this).val("")}),$(".text-picker").click(function(e){$("#mlSelectedColorText").off(),$("#mlColors").off(),$(".colorpicker")[1].style.left=e.clientX.toString()+"px",$(".colorpicker")[1].style.top=e.clientY.toString()+"px",$(".colorpicker_undo")[1].style.display="none",$("#colorpicker-holder-text").show(),$("#mlSelectedColorText").keyup(function(){o.onColorChange(this.value)}),$("#mlColors").mouseleave(function(){var e=$canvas.getActiveDobj(),t=$canvas.getOriginColorByObj(e.raw,e.id)
Object.keys(t).length&&o.onColorChange(rgb2hex(t.fill))})})}return e.prototype.onObjectSelected=function(t){var o=this
if(this.$scope.visible=t.type==DOType.ITEXT,!this.$scope.visible)return $(".object-option").hide()
var n=t.raw.fill
0===$cmd.history.length&&e.instance.primaryColorWasSet===!1&&(e.instance.primaryColor=n,e.instance.primaryColorWasSet=!0),$("#id-bold-btn").removeClass("active"),$("#id-italic-btn").removeClass("active"),this.hasWeight(t)&&$("#id-bold-btn").addClass("active"),this.hasStyle(t)&&$("#id-italic-btn").addClass("active"),t.raw.fontFamily&&(this.$scope.font_name=t.raw.fontFamily.firstToUppercase().allReplace({_:" ","-":" "}))
var s=rgb2hex(t.raw.fill)
o.oldColor=s.substring(1),o.newColor=s.substring(1),s.indexOf("#")<0&&(s="#"+s),$("#colorpicker-holder-text").ColorPickerSetColor(s),$(".text-picker").css("background-color",s),$(".text-picker").val(""),$(".symbolcolor").hide(),$(".object-option").show(),$(".symbol-container .symbol-color ").hide(),$(".symbol-container .symbol-transparency").hide(),$(".symbol-container .title").hide(),$(".object-option .text-container").show()},e.prototype.onObjectDeSelected=function(e){this.$scope.visible=!1,$(".object-option").hide(),$("#colorpicker-holder-text").hide()},e.prototype.onColorChange=function(t){var o=(e.instance,$canvas.getActiveDobj())
t.indexOf("#")==-1&&(t="#"+t),$(".text-picker").css("background-color",t),$(".text-picker").val(""),o.raw.fill=t,canvas.renderAll()},e.prototype.resetScaleButton=function(){var e=$("#id-plus-btn")
e.hasClass("input-active")&&e.removeClass("input-active")
var t=$("#id-minus-btn")
t.hasClass("input-active")&&t.removeClass("input-active")},e.prototype.scaleUp=function(e){var t=$canvas.getActiveObj(),o=t.width*t.getScaleX(),n=t.height*t.getScaleY(),s=t.getScaleX(),a=t.getScaleY(),i={x:s,y:a,t:t.top,l:t.left}
t.setScaleX(s+.1),t.setScaleY(a+.1)
var r=t.width*t.getScaleX(),l=t.height*t.getScaleY(),c=r-o,d=l-n
t.left-=c/2,t.top-=d/2
var p={x:t.getScaleX(),y:t.getScaleY(),t:t.top,l:t.left}
if(canvas.renderAll(),"click"==e.type||"mousedown"==e.type){var h=$("#id-plus-btn")
h.hasClass("input-active")||this.protectclick||h.addClass("input-active"),this.protectclick=!1}else{var h=$("#id-plus-btn")
h.hasClass("input-active")&&h.removeClass("input-active"),this.protectclick=!0}$cmd.run("scale",t,i,p)},e.prototype.scaleDown=function(e){var t=$canvas.getActiveObj(),o=t.width*t.getScaleX(),n=t.height*t.getScaleY(),s=t.getScaleX(),a=t.getScaleY(),i={x:s,y:a,t:t.top,l:t.left}
s-.1>t.minScaleLimit&&t.setScaleX(s-.1),a-.1>t.minScaleLimit&&t.setScaleY(a-.1)
var r=t.width*t.getScaleX(),l=t.height*t.getScaleY(),c=r-o,d=l-n
t.left-=c/2,t.top-=d/2
var p={x:t.getScaleX(),y:t.getScaleY(),t:t.top,l:t.left}
if(canvas.renderAll(),"click"==e.type||"mousedown"==e.type){var h=$("#id-minus-btn")
h.hasClass("input-active")||this.protectclick||h.addClass("input-active"),this.protectclick=!1}else{var h=$("#id-minus-btn")
h.hasClass("input-active")&&h.removeClass("input-active"),this.protectclick=!0}$cmd.run("scale",t,i,p)},e.prototype.onColorSelect=function(t){var o=e.instance,n=$canvas.getActiveDobj()
n.raw.fill
$(".colorpicker_undo")[1].style.display="block",o.oldColor=o.newColor,o.newColor=t
var s=rgb2hex($canvas.getOriginColorByObj(n.raw,n.id).fill)
o.primaryColorWasStored===!1?($cmd.run("text-color",n,o.primaryColor,t),o.primaryColorWasStored=!0):$cmd.run("text-color",n,s,t)},e.prototype.colorUndo=function(e){var t=this,o=$canvas.getActiveDobj()
if(null!=o){if(t.oldColor.indexOf("#")==-1&&(t.oldColor="#"+t.oldColor),$(".text-picker").css("background-color",t.oldColor),$(".text-picker").val(""),null==o.raw)return
o.raw.fill=t.oldColor,t.newColor=t.oldColor,$(".colorpicker_undo")[1].style.display="none",$("#colorpicker-holder-text").ColorPickerSetColor(t.oldColor)}},e.prototype.fontSelect=function(){this.$scope.font_name=$canvas.getActiveDobj().raw.fontFamily.firstToUppercase().allReplace({_:" ","-":" "})},e.prototype.fontWeight=function(e){var t=$.extend(!0,{},$canvas.getActiveDobj())
$cmd.run("text-font-weight",t.raw.fontWeight,e)},e.prototype.fontStyle=function(e){var t=$.extend(!0,{},$canvas.getActiveDobj())
$cmd.run("text-font-style",t.raw.fontStyle,e)},e.prototype.hasWeight=function(e){return"normal"!=e.raw.fontWeight},e.prototype.hasStyle=function(e){if(e.raw.fontStyle)return e.raw.fontStyle.length},e.prototype.toggleFontBold=function(e){var t=$canvas.getActiveDobj(),o=$(e.currentTarget)
this.hasWeight(t)?(this.fontWeight("normal"),o.removeClass("input-active")):(this.fontWeight("bold"),o.addClass("input-active"))},e.prototype.toggleFontItalic=function(e){var t=$canvas.getActiveDobj(),o=$(e.currentTarget)
this.hasStyle(t)?(this.fontStyle(""),o.removeClass("input-active")):(this.fontStyle("italic"),o.addClass("input-active"))},e.prototype.toggleTransparency=function(){var e=$canvas.activePaths
$cmd.run("symbol-transparency",e)},e.prototype.onFontClick=function(){msg.send("open-popup","fontselection")},e.prototype.onColorClick=function(e){},e.prototype.sendBackwards=function(){var e=canvas.getActiveObject()
e.sendBackwards()
var t=canvas.getObjects().indexOf(e),o=0===t,n=t==canvas.getObjects().length-1
$("#id-zindex-buttonbar").show(),$("#id-sendbackwards-btn").prop("disabled",o),$("#id-bringforward-btn").prop("disabled",n),$("#send-backwards-btn").prop("disabled",o),$("#bring-forward-btn").prop("disabled",n)},e.prototype.bringForward=function(){var e=$canvas.getActiveObj()
e.bringForward()
var t=canvas.getObjects().indexOf(e)
$("#id-sendbackwards-btn").prop("disabled",0==t),$("#id-bringforward-btn").prop("disabled",t==canvas.getObjects().length-1),$("#bring-forward-btn").prop("disabled",t==canvas.getObjects().length-1),$("#send-backwards-btn").prop("disabled",0==t)},e}(),RenameController=function(e){function t(t){e.call(this,t),this.init("rename"),$cmd.map("rename",this.rename,this),$cmd.mapUndo("rename",this.undoRename),msg.on("open-rename",this.popupRename,this)}return __extends(t,e),t.prototype.rename=function(e,t,o){$canvas.rename(e,o)},t.prototype.undoRename=function(e,t,o){$canvas.rename(e,t)},t.prototype.popupRename=function(){this.$scope.newname=$canvas.getActiveDobj().name},t.prototype.onOkClick=function(){if(!isEmptyObj($canvas.getActiveDobj())){var e=$canvas.getActiveDobj(),t=16
if(this.$scope.newname.length>t)return alert("Sorry, more than: "+t+" not allowd.")
$cmd.run("rename",e,e.name,this.$scope.newname),this.close()}},t.prototype.onCancelClick=function(){this.close()},t}(PopupController),SymbolColorController=function(){function e(e){var t=this
this.$scope=e,this.textColor=0,this.oldColor="fff",this.newColor="fff",this.onColorChange=function(e){t.enabled()&&($(".color-picker").css("background-color","#"+e),$cmd.run("symbol-color",$canvas.getActiveDobj(),"#"+$canvas.activePathsColor.toHex().toLowerCase(),"#"+e),t.textColor=e)},ObjectsController.instance=this,e.$=this,e.visible=!1,e.pathsVisible=!0,msg.on("object-selected",this.onObjectSelected,this),msg.on("paths-selected",this.onObjectSelected,this),msg.on("object-deselected",this.onObjectDeSelected,this),msg.on("deselect-all",this.onObjectDeSelected,this),msg.on("submit-undo",this.colorUndo,this),$("#colorpicker-holder-symbol").ColorPicker({flat:!0,onSubmit:function(e,o,n,s){var a
if(!$.isEmptyObject($canvas.getActiveObj())){t.oldColor=t.newColor,t.newColor=o,$(".colorpicker_undo")[0].style.display="block"
for(var i=$canvas.getActiveDobj(),r=$canvas.getActiveObj().getObjects(),l=$canvas.activePaths,c=0;c<r.length;c++)for(var d=0;d<l.length;d++)JSON.stringify(r[c])==JSON.stringify(l[d])&&(a=$.extend(!0,{},$canvas.getOriginColorByObj(r[c],i.id.toString()+c.toString())))}},onShow:function(){$(this).ColorPickerSetColor("0000")},onBeforeShow:function(){$(this).ColorPickerSetColor("0000")},onChange:function(e,t,o,n){var s=this
if(!$.isEmptyObject($canvas.getActiveObj())){for(var a,i=$canvas.getActiveDobj(),r=$canvas.getActiveObj().getObjects(),l=$canvas.activePaths,c=0;c<r.length;c++)for(var d=0;d<l.length;d++)void 0===l[c]&&null!==l[c]||void 0!=l[d].fill&&($canvas.activeStrokeColor||l[d].fill=="#"+t&&(t=t.substr(0,t.length-1)+Tools.makeid(1))),JSON.stringify(r[c])==JSON.stringify(l[d])&&(a=$.extend(!0,{},$canvas.getOriginColorByObj(r[c],i.id.toString()+c.toString())),$canvas.activeStrokeColor===!1?$canvas.setFillColor(l[d],i.id.toString()+c.toString(),"#"+t):(void 0!==l[d].fill&&null!==l[d].fill&&$canvas.setFillColor(l[d],i.id.toString()+c.toString(),l[d].fill),void 0!==l[d].stroke&&null!==l[d].stroke&&$canvas.setStrokeColor(l[d],i.id.toString()+c.toString(),"#"+t)))
$(".color-picker").css("background-color","#"+t),$canvas.activeStrokeColor===!1&&$cmd.run("symbol-color",$canvas.getActiveDobj(),a.fill,"#"+t),s.textColor=t}}}),$("#colorpicker-holder-symbol").hide(),$(".color-picker").keyup(function(){$(this).val("")}),$(".color-picker").click(function(e){$(".colorpicker")[0].style.left=e.clientX.toString()+"px",$(".colorpicker")[0].style.top=e.clientY.toString()+"px",$(".colorpicker_undo")[0].style.display="none",$("#colorpicker-holder-symbol").show(),$("#mlSelectedColorText").off(),$("#mlColors").off(),$canvas.reSetVisibilityGroup(),window.cancelRequestAnimFrame(window.renderAnimationFrame),window.colorpicker.controller="SymbolColorController",window.colorpicker.visible=!0,msg.send("remove-opacity-all")
var t=function(e){var t=this,o=t.value,n="#"+o,s={},a=/^[a-fA-F0-9]{6}|[a-fA-F0-9]{3}$/
if(13==e.keyCode&&$("#mlColorPicker").hide().removeData("mlOnChange"),o.match(a)&&(3==o.length||6==o.length)){if($canvas.activeStrokeColor!==!1)for(var i=0;i<$canvas.activePaths.length;i++)s=$canvas.activePaths[i],s.getStroke()&&$canvas.pathStrokeColor(s,s.getStroke(),n),$canvas.activePaths[i].fill.toLowerCase()==$canvas.activeStrokeColor&&(s=$canvas.activePaths[i],$canvas.pathFillColor(s,s.fill,n),$canvas.activeStrokeColor=n)
else $canvas.symbolColor($canvas.getActiveDobj(),$canvas.activePaths[0].fill,n)
$("#mlSelectedColorDiv").css("background-color","#"+o),$(".color-picker").css("background-color","#"+o)}},o=function(){for(var e=$canvas.getActiveDobj(),t=$canvas.getActiveObj().getObjects(),o=$canvas.activePaths,n=0;n<t.length;n++)for(var s=0;s<o.length;s++)if(JSON.stringify(t[n])==JSON.stringify(o[s])){var a=$canvas.getOriginColorByObj(t[n],e.id.toString()+n.toString())
$canvas.activeStrokeColor===!1?(void 0!==a.fill&&(0!==a.fill.length&&null!==a.fill||(a.fill="#000")),t[n].setFill(a.fill)):(void 0!==a.stroke&&(0!==a.stroke.length&&null!==a.stroke||(a.stroke="#000")),t[n].setStroke(a.stroke))}}
$("#mlSelectedColorText").on("keyup",t),$("#mlColors").on("mouseleave",o)})}return e.prototype.enabled=function(e){return 0===$canvas.selection.length&&$canvas.selection.push(e),$canvas.selection[0].type==DOType.SYMBOL},e.prototype.colorUndo=function(e){var t=this
t.newColor=t.oldColor,$(".colorpicker_undo")[0].style.display="none",$("#colorpicker-holder-symbol").ColorPickerSetColor(t.oldColor)
if(!$.isEmptyObject($canvas.getActiveObj())&&$canvas.getActiveObj().hasOwnProperty("paths")){for(var o,e=$canvas.getActiveDobj(),n=$canvas.getActiveObj().getObjects(),s=$canvas.activePaths,a=0;a<n.length;a++)for(var i=0;i<s.length;i++)JSON.stringify(n[a])==JSON.stringify(s[i])&&(o=$.extend(!0,{},$canvas.getOriginColorByObj(n[a],e.id.toString()+a.toString())),$canvas.activeStrokeColor===!1?$canvas.setFillColor(s[i],e.id.toString()+a.toString(),"#"+t.oldColor):(void 0!==s[i].fill&&null!==s[i].fill&&$canvas.setFillColor(s[i],e.id.toString()+a.toString(),s[i].fill),void 0!==s[i].stroke&&null!==s[i].stroke&&$canvas.setStrokeColor(s[i],e.id.toString()+a.toString(),"#"+t.oldColor)))
$(".color-picker").css("background-color","#"+t.oldColor),$canvas.activeStrokeColor===!1&&$cmd.run("symbol-color",$canvas.getActiveDobj(),o.fill,"#"+t.oldColor),t.textColor=t.oldColor,$cmd.run("symbol-color",$canvas.getActiveDobj(),o.fill,"#"+t.oldColor)}},e.prototype.onObjectSelected=function(e){var t=this
if((e.type==DOType.IMAGE||e.type==DOType.SYMBOL)&&null!==e&&void 0!==e){msg.send("clear-action-buttons"),this.onObjectDeSelected(),this.$scope.pathsVisible=!0,this.$scope.visible=this.enabled(e),e.type==DOType.SYMBOL&&(t.oldColor=$canvas.activePathsColor.toHex().toLowerCase(),t.newColor=$canvas.activePathsColor.toHex().toLowerCase(),$("#colorpicker-holder-symbol").ColorPickerSetColor($canvas.activePathsColor.toHex().toLowerCase()),$(".color-picker").css("background-color","#"+$canvas.activePathsColor.toHex().toLowerCase()))
for(var o=$canvas.activePaths,n=0;n<o.length;n++)o[n].hasOwnProperty("invisible")&&o[n].invisible&&(this.$scope.pathsVisible=!1)
canvas.getObjects().length>1&&($(".object-option").show(),$(".title").show(),$("#colorpicker-holder-symbol").hide(),$(".object-option .text-container").hide())
var s=0
if($canvas.activePaths.length>0){s=e.type==DOType.SYMBOL?e.raw.paths.length:0
var a=$canvas.activePaths[0]
a.hasOwnProperty("invisible")&&a.invisible?$("#transparency-eye").removeClass("fa fa-eye").addClass("fa fa-eye-slash"):$("#transparency-eye").removeClass("fa fa-eye-slash").addClass("fa fa-eye"),this.$scope.visible&&($(".object-option").show(),$(".title").show(),a.invisible||$(".symbol-container .symbol-color").show(),s>1&&$(".symbol-container .symbol-transparency").show(),$(".object-option .text-container").hide())}}},e.prototype.onObjectDeSelected=function(){$(".object-option").hide(),$(".symbol-container .symbol-color").hide(),$("#colorpicker-holder-symbol").hide(),$(".symbol-container .symbol-transparency").hide(),this.$scope.visible=!1},e.prototype.onFontClick=function(){msg.send("open-popup","fontselection")},e.prototype.onInvisibleClick=function(e){this.$scope.pathsVisible=!this.$scope.pathsVisible,$cmd.run("symbol-visibility",$canvas.activePaths)},e}(),GuidedTourController=function(){function e(e){var t=this
this.$scope=e,this.$scope.$=this,e.tourActive=!1,e.addTextFrame=!1,e.addSymbolFrame=!1,e.toolsFrame=!1,e.fileToolFrame=!1,e.textTour="Logo Maker",e.symbolTour="http://www.onlinelogomaker.com/logomaker/assets/svg/abstract/Sym-1.svg",msg.on("activate-guided-tour",this.activateGuidedTour,this),msg.on("update-size-guided-tour",this.updateSize,this),msg.on("continue-1",this.continue_1,this),msg.on("is-active-guided-tour",this.isActive,this),msg.on("add-symbol-guided-tour",this.addSymbolFromSymbolController,this),$(window).on("resize",function(){msg.send("update-size-guided-tour")}),$("#olm-gt-add-text-input").on("keyup",function(e){13==e.keyCode&&t.continueClick(1)}),$(".olm-gt-symbol").on("dblclick",function(){t.continueClick(2)})}return e.prototype.init=function(){this.updateSize(),this.addTextFrame()},e.prototype.updateSize=function(){if(this.$scope.tourActive){var e=$("#olm-right-navbar").width()+10,t=$(window).width(),o=$("#olm-right-navbar").position(),n=t-e-o.left
$("#olm-gt-filetools-left").css("width",o.left+"px"),$("#olm-gt-filetools").css("width",e+"px"),$("#olm-gt-filetools-right").css("width",n+"px")
var s=parseInt($("#olm-addt").css("height")),a=parseInt($("#olm-adds").css("height")),i=parseInt($("#olm-uplimg").css("height"))
leftPaneOff=$(window).height()-63-15-s-a-i,$("#olm-gt-add-text").css("height",s+"px"),$("#olm-gt-add-symbol").css("height",a+"px"),$("#olm-gt-upload-image").css("height",i+"px"),$("#olm-gt-off").css("height",leftPaneOff+"px")}},e.prototype.activateGuidedTour=function(){this.$scope.tourActive=!0,this.$scope.$apply(),this.init()},e.prototype.isActive=function(e){e.resp=this.$scope.tourActive},e.prototype.addSymbolFromSymbolController=function(e){$(".olm-guided-tour").css("z-index",1e4),$(".olm-check-symbol").css("display","none"),$("#olm-check-symbol-11").css("display","inherit"),this.$scope.symbolTour=e
var t='<img id="olm-svg-symbol-11" src="'+e+'"></img>'
$("#symbol-11").length&&$("#olm-svg-symbol-11").remove(),$("#symbol-11").append(t),$("#symbol-11").css("border","2px solid #E74C3B")},e.prototype.moreSymbols=function(){$(".olm-guided-tour").css("z-index",-1),msg.send("open-symbols")},e.prototype.deactivateGuidedTour=function(){this.$scope.tourActive=!1},e.prototype.skipClick=function(){this.$scope.addTextFrame||this.addElementsTour(),this.deactivateGuidedTour()},e.prototype.addTextFrame=function(){this.$scope.addTextFrame=!0,this.$scope.$apply(),$("#olm-gt-add-text").css("opacity",0)},e.prototype.remAddTextFrame=function(){this.$scope.addTextFrame=!1,this.$scope.$apply(),$("#olm-gt-add-text").css("opacity",1)},e.prototype.addSymbolFrame=function(){this.addGuidedSymbols(),this.$scope.addSymbolFrame=!0,this.$scope.$apply(),$("#olm-gt-add-symbol").css("opacity",0)},e.prototype.remAddSymbolFrame=function(){this.$scope.addSymbolFrame=!1,this.$scope.$apply(),$("#olm-gt-add-symbol").css("opacity",1)},e.prototype.toolsFrame=function(){this.$scope.toolsFrame=!0,this.$scope.$apply(),$("#olm-gt-add-symbol").css("opacity",0),$("#olm-gt-add-text").css("opacity",0),$("#olm-gt-upload-image").css("opacity",0)},e.prototype.remToolsFrame=function(){this.$scope.toolsFrame=!1,$("#olm-gt-add-symbol").css("opacity",1),$("#olm-gt-add-text").css("opacity",1),$("#olm-gt-upload-image").css("opacity",1)},e.prototype.fileToolFrame=function(){this.$scope.fileToolFrame=!0,$("#olm-gt-filetools").css("opacity",0)},e.prototype.remFileToolFrame=function(){this.$scope.fileToolFrame=!1,this.$scope.$apply(),$("#olm-gt-right-nav").css("opacity",1)},e.prototype.continueClick=function(e){switch(e){case 1:var t=$("#olm-gt-add-text-input").val()
""!==t?this.$scope.textTour=t:$("#olm-gt-add-text-input").val(this.$scope.textTour),setTimeout(function(){msg.send("continue-1")},1e3)
break
case 2:this.remAddSymbolFrame(),this.toolsFrame()
break
case 3:this.remToolsFrame(),this.fileToolFrame()
break
case 4:this.addElementsTour(),this.deactivateGuidedTour()}},e.prototype.addElementsTour=function(){var e=this
msg.send("add-symbol",e.$scope.symbolTour,10,10),msg.send("add-text",e.$scope.textTour,10,10),setTimeout(function(){canvas.item(1).left=canvas.width/2,canvas.item(1).top=canvas.height/4,canvas.item(0).left=canvas.item(1).left-canvas.item(0).width/2+canvas.item(1).width*canvas.item(1).scaleX/2,canvas.item(0).top=canvas.item(1).top+canvas.item(1).height*canvas.item(1).scaleY,canvas.item(0).setCoords(),canvas.item(1).setCoords()},1e3)},e.prototype.clickSymbol=function(e){var t=e.currentTarget.id,o="#olm-svg-"+t,n="#olm-check-"+t
$(".olm-check-symbol").css("display","none"),$(n).css("display","inherit"),this.$scope.symbolTour=$(o).attr("src")},e.prototype.continue_1=function(){this.remAddTextFrame(),this.addSymbolFrame(),$("#olm-check-symbol-1").css("display","inherit")},e.prototype.addGuidedSymbols=function(){for(var e,t,o=0;o<=10;o++)e="#olm-svg-symbol-"+o,t="http://www.onlinelogomaker.com/logomaker/assets/svg/abstract/Sym-"+o+".svg",$(e).attr("src",t)},e}(),WelcomeController=function(){function e(e,t){this.$scope=e,this.visible=!0,e.$=this,this.lInstance=new LoginController(e,t,this),msg.on("init-project",this.init,this)}return e.prototype.open=function(){this.$scope.visible=!0,this.$scope.text=""},e.prototype.onOkClick=function(){this.visible=!1,msg.send("close-popups")},e.prototype.loadProject=function(e,t){var o=this.lInstance,n=Math.floor(13*Math.random()),s="local_projects/json/default_"+n.toString()+".olmn?v=0.002"
ga("send","event","App Click","Visitor","New visitor"),window.loadSample=e,o=e?this.lInstance.fakeLoginPromise():this.lInstance.loginPromise(),o.then(function(){setTimeout(function(){is_clone=!1,shadow="",x=50,y=50,e?window.defaultproject=!0:s="https://www.onlinelogomaker.com/applet_userdata/"+window.user.id+"/projects/"+t,window.projectDataUrl=s,$.get(s,function(e,t){canvas.clear()
var o=JSON.parse(e)
o.bgColor&&($cmd.run("background-color",$oCanvasColor.previous,o.bgColor.replace("#","")),$(".background-picker div").css("background-color",o.bgColor)),canvas.loadFromJSON(o,function(){objects=canvas.getObjects()
for(var e=0;e<objects.length;e++){var t=new DisplayObject
$canvas.idIndex++,t.id=e,t.name="OBJECT"+e,t.selected=!0,t.color="",t.raw=objects[e],t.shadow={enabled:!1,color:"#000",blur:5,offsetX:9.84807753012208,offsetY:1.7364817766693033,direction:10,outset:10,opacity:.6,fillShadow:!0,strokeShadow:!0},t.glow={enabled:!1,color:"rgba(0,0,0,0.6)",blur:40,offsetX:0,offsetY:0,opacity:.6,fillShadow:!0,strokeShadow:!0},"path-group"==objects[e].type&&(type=DOType.SYMBOL),"text"==objects[e].type&&(type=DOType.TEXT),"i-text"==objects[e].type&&(type=DOType.ITEXT),"image"==objects[e].type&&(type=DOType.IMAGE),t.type=type,$canvas.children.unshift(t)}var o={},n={},s={}
for(e=0;e<$canvas.children.length;e++)if(o={},s=$canvas.children[e],o.id=s.id,o.fill=s.raw.fill,o.stroke=s.raw.stroke,o.shadow=s.raw.shadow,o.raw=JSON.stringify(s.raw),$oColors.push(o),s.type==DOType.SYMBOL){n=s.raw.getObjects()
for(var a=0;a<n.length;a++)o={},o.id=s.id.toString()+a.toString(),o.fill=n[a].fill,o.stroke=n[a].stroke,o.shadow=s.shadow,o.raw=JSON.stringify(n[a]),$oColors.push(o)}var i=$(".leftpane").width(),r=$(".topPane").height(),l=canvas.height-r,c=canvas.width-i
$canvas.selectAll()
var d=l/canvas.getActiveGroup().height,p=c/canvas.getActiveGroup().width,h=canvas.getActiveGroup().height,g=canvas.getActiveGroup().width
do(d<1||p<1)&&(canvas.getActiveGroup().scaleY*=.8,canvas.getActiveGroup().scaleX*=.8,h*=.8,g*=.8),d=l/g,p=c/g
while(d<1||p<1)
canvas.getActiveGroup().left=(c+2*i)/2,canvas.getActiveGroup().top=(l+2*r)/2,canvas.deactivateAllWithDispatch().renderAll(),msg.send("deselect-all"),msg.send("project-loaded")})})},600)})},e.prototype.init=function(){var e=getQueryVariable("project")
return e?(this.loadProject(loadSample=!1,e),null):void this.loadProject(loadSample=!0)},e}(),InitController=function(){function e(e,t){this.htmlAppContainer=$(".logomaker.container"),this.htmlWelcomeModal=$("#welcome-modal"),window.onbeforeunload=function(){return"Do you really want to close?"},this.lInstance=new LoginController(e,t,this),this.init()}return e.prototype.welcomeModal=function(){var e=this
e.htmlWelcomeModal.fadeIn("slow"),setTimeout(function(){e.htmlWelcomeModal.fadeOut("slow")},6e3)},e.prototype.init=function(){var e=this
$(window).load(function(){Tools.translatePage(),$("#preloader").remove(),e.htmlAppContainer.fadeIn("slow",function(){setInterval(function(){null!==canvas.getActiveObject()&&void 0!==canvas.getActiveObject()||msg.send("clear-action-buttons"),canvas.renderAll()},1e3),e.welcomeModal()
var t=parseInt(getQueryVariable("v"))
switch(t){case 1:msg.send("open-symbols")
break
case 2:msg.send("activate-guided-tour")
break
default:var o="local_projects/json/sample.dolm?v=0.001",n=getQueryVariable("project"),s=!n
s?loginPromise=e.lInstance.fakeLoginPromise():loginPromise=e.lInstance.loginPromise(),loginPromise.then(function(){setTimeout(function(){s||(o="https://www.onlinelogomaker.com/applet_userdata/"+window.user.id+"/projects/"+n),$.get(o,function(e,t){canvas.clear()
var o=JSON.parse(e)
for(i=0;i<o.objects.length;i++)"i-text"==o.objects[i].type&&(text=new fabric.IText("Logo Maker",{fontFamily:o.objects[i].fontFamily,fontSize:2,padding:0}),msg.send("add",$canvas.create(DOType.ITEXT,text),!1,-100,-100))
setTimeout(function(){msg.send("init-project")},1500)})},600)})}})})},e}()
